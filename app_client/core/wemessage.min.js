!function(){function e(e,t,o){e.when("/",{templateUrl:"home/home.view.html",controller:"homeCtrl",controllerAs:"vm"}).when("/chat/:roomid",{templateUrl:"/chat/chat.view.html",controller:"chatCtrl",controllerAs:"vm"}).when("/contacts",{templateUrl:"/contacts/contacts.view.html",controller:"contactsCtrl",controllerAs:"vm"}).when("/account/:accountid/thread/:contactName/:contactid",{templateUrl:"/conversation/conversation.view.html",controller:"conversationCtrl",controllerAs:"vm"}).when("/account-info/:contactid",{templateUrl:"/contactDetail/contactDetail.view.html",controller:"contactDetailCtrl",controllerAs:"vm"}).when("/chat-home",{templateUrl:"/static/static.view.html",controller:"chatHomeCtrl",controllerAs:"vm"}).otherwise({redirectTo:"/"}),t.html5Mode({enabled:!0,requireBase:!1});var a=":8080";o.setConnectionUrl(window.location.hostname+a)}angular.module("weMessageApp",["ngRoute","ngSanitize","socket.io","ui.bootstrap"]),angular.module("weMessageApp").config(["$routeProvider","$locationProvider","$socketProvider",e])}(),function(){function e(e,t,o,a,n){var r=this;r.setRoomName=function(e){return e=e.split("-").join(" "),e.split("_").join(" ")},r.roomid=t.roomid,r.chatName=r.setRoomName(r.roomid)||"Instant Chat",r.alertMessage="",r.messageThread=r.messageThread||[],r.userId=r.userId||localStorage.getItem("userId")||"",r.chatRoomUsers=[],o.on("set-id",function(e){r.userId=e,localStorage.setItem("userId",e)}),o.on("nickname-set",function(e){r.nickname=e,localStorage.nickname=e}),o.on("chatroom-message",function(e){var t=e.username||r.nickname||"",o={content:e.message,selfClasses:"",showNickname:!0,username:t};r.userId==e.sender?(o.selfClasses="self-sent text-right",o.showNickname=!1):"the socket master"==e.sender&&(o.selfClasses="bold text-center",o.showNickname=!1),r.messageThread.push(o),$("html, body").animate({scrollTop:$("#message-input-anchor").offset().top},"slow")}),r.sendMessage=function(){return r.messageToSend&&(o.emit("chatroom-message",r.messageToSend),r.messageToSend=""),!1},e.uploadImage=function(t){n.readImage(t,r.emitImage,e)},r.emitImage=function(e){o.emit("chatroom-message",e.target.result)},r.chatNicknamePopup=function(){a.open({backdrop:"static",keyboard:!1,templateUrl:"/modals/chatNickname/chatNickname.view.html",controller:"chatNicknameCtrl as vm",resolve:{chatRoomData:function(){return{roomid:r.roomid}}}})},r.nickname||r.chatNicknamePopup(),r.getUsers=function(){o.emit("request-sockets-in-room")},o.on("deliver-sockets-in-room",function(e){r.chatRoomUsers=e}),r.emailInvitePopup=function(){var e=a.open({templateUrl:"/modals/emailInvite/emailInvite.view.html",controller:"emailInviteCtrl as vm",resolve:{senderInfo:function(){return{sender:r.nickname,chatUrl:window.location.href}}}});e.result.then(function(e){if(e){var t={content:e,selfClasses:"bold text-center",showNickname:!1,username:""};r.messageThread.push(t)}})},r.sendMessageACK=function(){o.emit("echo-ack",r.dataToSend,function(e){r.serverResponseACK=e}),r.dataToSend=""}}angular.module("weMessageApp").controller("chatCtrl",e),e.$inject=["$scope","$routeParams","$socket","$uibModal","fileReader"]}(),function(){function e(e,t,o,a){var n=this;n.detailUrl=a.apiUrl+"/account/"+t.contactid,o({method:"GET",url:n.detailUrl,headers:{Authorization:"Bearer "+localStorage.getItem("authToken")}}).then(function(e){n.contact=e.data},function(e){console.log(e)}),n.onClickBack=a.onClickBack}angular.module("weMessageApp").controller("contactDetailCtrl",e),e.$inject=["$scope","$routeParams","$http","constants"]}(),function(){function e(e,t,o,a){var n=this;n.accountid=localStorage.getItem("accountid"),n.accountName=localStorage.getItem("accountName"),n.alertMessage="",n.apiUrl=a.apiUrl,n.contactsUrl=n.apiUrl+"/account-contacts",n.hasContacts=!0,t({method:"GET",url:n.contactsUrl,headers:{Authorization:"Bearer "+localStorage.getItem("authToken")}}).then(function(e){n.contacts=e.data,n.contacts&&n.contacts.length>0?n.hasContacts=!0:n.hasContacts=!1;for(var t=0;t<n.contacts.length;t++){var o=n.contacts[t].id;n.contacts[t].conversationUrl="/account/"+n.accountid+"/thread/"+n.contacts[t].name+"/"+o;n.getLatestMessage(o,t)}},function(e){n.hasContacts=!1,console.log(e)}),n.getLatestMessage=function(e,o){var a=n.apiUrl+"/messages/sender/"+n.accountid+"/recipient/"+e+"/latest";t({method:"GET",url:a,headers:{Authorization:"Bearer "+localStorage.getItem("authToken")}}).then(function(e){e.data&&(n.contacts[o].latestMessage=e.data)},function(e){console.log(e)})},n.onClickBack=a.onClickBack,n.addContactPopup=function(){var e=o.open({templateUrl:"/modals/addContact/addContact.view.html",controller:"addContactCtrl as vm"});e.result.then(function(e){e.id&&(e.conversationUrl="/account/"+n.accountid+"/thread/"+e.name+"/"+e.id,n.hasContacts=!0,n.contacts.push(e))})}}angular.module("weMessageApp").controller("contactsCtrl",e),e.$inject=["$scope","$http","$uibModal","constants"]}(),function(){function e(e,t,o,a,n,r){var c=this;c.accountid=t.accountid,c.userId=c.userId||localStorage.getItem("userId")||"",c.contact={id:t.contactid,name:t.contactName,shortName:t.contactName.split(" ")[0],url:"/account-info/"+t.contactid},c.threadUrl=n.apiUrl+"/messages/sender/"+c.accountid+"/recipient/"+c.contact.id,c.newMessageUrl=n.apiUrl+"/messages/",c.accountName=localStorage.getItem("accountName"),c.alertMessage="",c.messageThread=[],a({method:"GET",url:c.threadUrl,headers:{Authorization:"Bearer "+localStorage.getItem("authToken")}}).then(function(e){if(c.messageThread=e.data,c.messageThread){for(var t=0;t<c.messageThread.length;t++)c.messageThread[t].sender_account==c.accountid?(c.messageThread[t].selfClasses="self-sent text-right",c.messageThread[t].showNickname=!1):(c.messageThread[t].showNickname=!0,c.messageThread[t].username=c.contact.shortName);c.scrollToEnd()}},function(e){console.log(e)});var s=[c.accountid,c.contact.id];s.sort(function(e,t){return e-t}),c.roomid="convo-"+s[0]+"-"+s[1],o.emit("join-room",{roomid:c.roomid,nickname:c.accountName,conversation:!0}),o.on("set-id",function(e){c.userId=e,localStorage.setItem("userId",e)}),o.on("chatroom-message",function(e){var t=e.username||c.nickname||"",o={content:e.message,selfClasses:"",showNickname:!0,username:t};c.userId==e.sender?(o.selfClasses="self-sent text-right",o.showNickname=!1):"the socket master"==e.sender&&(o.selfClasses="bold text-center",o.showNickname=!1),c.messageThread.push(o),c.scrollToEnd()}),c.sendMessage=function(){return c.messageToSend&&c.emitAndPostMessage(c.messageToSend),!1},c.emitAndPostMessage=function(e){o.emit("chatroom-message",e),a({method:"POST",url:c.newMessageUrl,data:{sender_account:c.accountid,recipient_account:c.contact.id,content:e},headers:{Authorization:"Bearer "+localStorage.getItem("authToken")}}).then(function(e){console.log(e)},function(e){console.log(e)}),c.messageToSend=""},e.uploadImage=function(t){r.readImage(t,c.sendImage,e)},c.sendImage=function(e){c.emitAndPostMessage(e.target.result)},c.scrollToEnd=function(){$("html, body").animate({scrollTop:$("#message-input-anchor").offset().top},"slow")},c.onClickBack=n.onClickBack}angular.module("weMessageApp").controller("conversationCtrl",e),e.$inject=["$scope","$routeParams","$socket","$http","constants","fileReader"]}(),function(){function e(e,t,o,a){var n=this;n.newChatPopup=function(){t.open({templateUrl:"/modals/newChat/newChat.view.html",controller:"newChatCtrl as vm"})},n.registrationPopup=function(){t.open({templateUrl:"/modals/register/register.view.html",controller:"registerCtrl as vm"})},n.loginPopup=function(){t.open({templateUrl:"/modals/login/login.view.html",controller:"loginCtrl as vm"})},o({method:"GET",url:a.apiUrl}).then(function(e){console.log(e)},function(e){console.log(e)})}angular.module("weMessageApp").controller("homeCtrl",e),e.$inject=["$scope","$uibModal","$http","constants"]}(),function(){function e(e,t){var o=this;o.pageTitle="WeMessage Chat",o.onClickBack=t.onClickBack}angular.module("weMessageApp").controller("chatHomeCtrl",e),e.$inject=["$scope","constants"]}(),function(){function e(){var e="https://obscure-forest-50106.herokuapp.com",t=function(){window.history.back()};return{apiUrl:e,onClickBack:t}}angular.module("weMessageApp").service("constants",e)}(),function(){function e(){var e=new Date;return{now:e}}angular.module("weMessageApp").service("currentTime",e)}(),function(){function e(){var e=function(e,t,o){o.$apply(function(o){var a=e.files[0],n=!1;if(-1!=a.type.search("image")&&(n=!0),n){var r=new FileReader;r.onload=function(e){t(e)},r.readAsDataURL(a)}})};return{readImage:e}}angular.module("weMessageApp").service("fileReader",e)}(),function(){function e(){function e(e){var t=[],o=e.search(/(https?:\/\/)?([\da-z\.-]+)\.([a-z\.]{2,6})([\/\w \.-]*)*\/?/);if(-1!=o){for(var a=e.split(" "),n=0;n<a.length;n++)if(-1!=a[n].search(/(https?:\/\/)?([\da-z\.-]+)\.([a-z\.]{2,6})([\/\w \.-]*)*\/?/)){for(var r=a[n],c=r,s=[".",",",";",":","?","\\"],l=0;l<s.length;l++)if(c.endsWith(s[l])){var i=c.split(s[l]);i.pop(),c=i.join(s[l]);break}-1==c.search(/^http.*$/)&&(c="http://"+c),a[n]='<a href="'+c+'" target="_blank">'+r+"</a>",t.push(c)}e=a.join(" ")}return{content:e,links:t}}function t(e,t){for(var o=t.length,a=0;o>a;a++){var n=t[a];(n.endsWith("jpg")||n.endsWith("png")||n.endsWith("gif"))&&(e+='<br><img src="'+n+'">',t.splice(a,1))}return{content:e,links:t}}function o(e){return-1!=e.search("data:image/")?e='<img src="'+e+'">':!1}return function(a){if(o(a))return a=o(a);var n=e(a);if(n.links){var r=t(n.content,n.links);a=r.content}return a}}angular.module("weMessageApp").filter("prettifyMessage",e)}(),function(){function e(e,t,o){var a=this;a.searchUrl=o.apiUrl+"/accounts/search/",a.createUrl=o.apiUrl+"/contacts",a.accountid=localStorage.getItem("accountid"),a.foundContacts=[],a.numSelected=0,a.getSelected=function(e){for(var t=[],o=0;o<e.length;o++)e[o].added&&t.push(e[o].id);return t},a.queryKeyUp=function(){a.formData.query.length>0?t({method:"GET",url:a.searchUrl+a.formData.query}).then(function(e){a.foundContacts=e.data,a.numSelected=a.getSelected(a.foundContacts).length},function(e){console.log(e)}):a.foundContacts=[]},a.selectContact=function(e){1==e.added?e.added=!1:e.added=!0,a.numSelected=a.getSelected(a.foundContacts).length},a.clickAdd=function(){for(var o=a.getSelected(a.foundContacts),n=0;n<o.length;n++)t({method:"POST",url:a.createUrl,data:{adder_id:a.accountid,added_id:o[n]},headers:{Authorization:"Bearer "+localStorage.getItem("authToken")}}).then(function(t){e.close(t.data)},function(e){console.log(e)})},a.closeModal=function(){e.close()}}angular.module("weMessageApp").controller("addContactCtrl",e),e.$inject=["$uibModalInstance","$http","constants"]}(),function(){function e(e,t,o){var a=this;a.roomid=o.roomid,a.onSubmit=function(){return a.formError="",a.formData=a.formData||{},a.formData.nickname?a.joinRoom(a.formData):a.formError="Please enter a nickname.",!1},a.joinRoom=function(e){return e.nickname&&t.emit("join-room",{roomid:a.roomid,nickname:e.nickname}),!1},a.closeModal=function(t){e.close(t)},t.on("nickname-set",function(e){a.closeModal(e)})}angular.module("weMessageApp").controller("chatNicknameCtrl",e),e.$inject=["$uibModalInstance","$socket","chatRoomData"]}(),function(){function e(e,t,o){var a=this;a.formData={},a.formData.sender=o.sender,a.chatUrl=o.chatUrl,a.onClickSend=function(){return console.log("why"),a.formError="",a.formData=a.formData||{},a.formData.sender&&a.formData.recipientName&&a.formData.recipientEmail?(a.sendMail(a.formData),a.closeModal("Your invitation was sent.")):a.formError="Please complete all fields.",!1},a.sendMail=function(e){var o={sender:e.sender,chatUrl:a.chatUrl,recipientName:e.recipientName,recipientEmail:e.recipientEmail};t.post("/email/invite-to-chat",o)},a.closeModal=function(t){e.close(t)},a.onClickCancel=function(){a.closeModal(!1)},a.testFunction=function(){console.log("test")}}angular.module("weMessageApp").controller("emailInviteCtrl",e),e.$inject=["$uibModalInstance","$http","senderInfo"]}(),function(){function e(e,t,o,a){var n=this;n.formData={},n.loginUrl=a.apiUrl+"/authenticate/",n.onClickLogin=function(){return n.formError="",n.formData=n.formData||{},n.formData.email&&n.formData.password?(console.log("form submitted"),t({method:"POST",url:n.loginUrl,data:{email:n.formData.email,password:n.formData.password}}).then(function(e){n.formError="",localStorage.setItem("loggedIn","true"),localStorage.setItem("authToken",e.data.auth_token),localStorage.setItem("accountid",e.data.account.id),localStorage.setItem("accountName",e.data.account.name);var t="/contacts";o.path(t)},function(e){e.data.errors&&(n.formError=e.data.errors[0])})):n.formError="Please complete all fields.",!1},n.onClickCancel=function(){e.close()}}angular.module("weMessageApp").controller("loginCtrl",e),e.$inject=["$uibModalInstance","$http","$location","constants"]}(),function(){function e(e,t){var o=this;o.onConfirmLogout=function(){return console.log("confirmed"),localStorage.clear(),o.closeModal(),t.path("/"),!1},o.closeModal=function(){e.close()}}angular.module("weMessageApp").controller("logoutCtrl",e),e.$inject=["$uibModalInstance","$location"]}(),function(){function e(e,t){var o=this;o.onSubmit=function(){return o.formError="",o.formData=o.formData||{},o.formData.roomName?(o.formError="",t.path("/chat/"+o.formData.roomName)):o.formError="Please enter a name for your chatroom.",!1},o.closeModal=function(){e.close()}}angular.module("weMessageApp").controller("newChatCtrl",e),e.$inject=["$uibModalInstance","$location"]}(),function(){function e(e,t,o,a,n,r){var c=this;c.formData={},c.registerUrl=r.apiUrl+"/register/",c.onClickRegister=function(){return c.formError="",c.formData=c.formData||{},c.formData.name&&c.formData.email&&c.formData.password?(console.log("form submitted"),t({method:"POST",url:c.registerUrl,data:{name:c.formData.name,email:c.formData.email,password:c.formData.password,image:c.profileImage}}).then(function(e){c.formError="",localStorage.setItem("loggedIn","true"),localStorage.setItem("authToken",e.data.auth_token),localStorage.setItem("accountid",e.data.account.id),localStorage.setItem("accountName",e.data.account.name),o.path("/contacts")},function(e){e.data.email?c.formError="We already have an account associated with that email address.":e.data.password?c.formError="Please use a password of six characters or more.":c.formError="There was an error processing your registration, please try again later."})):c.formError="Please complete all required fields.",!1},a.uploadImage=function(e){n.readImage(e,c.setProfileImage,a)},c.setProfileImage=function(e){var t=e.target.result;t&&a.$apply(function(){c.profileImage=t})},c.onClickCancel=function(){e.close()}}angular.module("weMessageApp").controller("registerCtrl",e),e.$inject=["$uibModalInstance","$http","$location","$scope","fileReader","constants"]}(),function(){function e(e){return{restrict:"EA",scope:{},link:function(t){t.todaysDate=e.now},templateUrl:"/common/directives/mainFooter/mainFooter.template.html"}}angular.module("weMessageApp").directive("mainFooter",["currentTime",e]),e.$inject=["currentTime"]}(),function(){function e(e){var t=function(){console.log("whattup");e.open({templateUrl:"/modals/logout/logout.view.html",controller:"logoutCtrl as vm"})};return{restrict:"EA",templateUrl:"/common/directives/mainNavigation/mainNavigation.template.html",link:function(e){e.onClickLogout=t,e.loggedIn=localStorage.getItem("loggedIn")}}}angular.module("weMessageApp").directive("mainNavigation",e),e.$inject=["$uibModal"]}(),function(){function e(){return{restrict:"EA",require:"ngModel",templateUrl:"/common/directives/messageEntry/messageEntry.template.html"}}angular.module("weMessageApp").directive("messageEntry",e)}();
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcC5qcyIsImNoYXQvY2hhdC5jb250cm9sbGVyLmpzIiwiY29udGFjdERldGFpbC9jb250YWN0RGV0YWlsLmNvbnRyb2xsZXIuanMiLCJjb250YWN0cy9jb250YWN0cy5jb250cm9sbGVyLmpzIiwiY29udmVyc2F0aW9uL2NvbnZlcnNhdGlvbi5jb250cm9sbGVyLmpzIiwiaG9tZS9ob21lLmNvbnRyb2xsZXIuanMiLCJzdGF0aWMvY2hhdEhvbWUuY29udHJvbGxlci5qcyIsImNvbW1vbi9zZXJ2aWNlcy9jb25zdGFudHMuc2VydmljZS5qcyIsImNvbW1vbi9zZXJ2aWNlcy9jdXJyZW50VGltZS5zZXJ2aWNlLmpzIiwiY29tbW9uL3NlcnZpY2VzL2ZpbGVSZWFkZXIuc2VydmljZS5qcyIsImNvbW1vbi9maWx0ZXJzL3ByZXR0aWZ5TWVzc2FnZS5maWx0ZXIuanMiLCJtb2RhbHMvYWRkQ29udGFjdC9hZGRDb250YWN0LmNvbnRyb2xsZXIuanMiLCJtb2RhbHMvY2hhdE5pY2tuYW1lL2NoYXROaWNrbmFtZS5jb250cm9sbGVyLmpzIiwibW9kYWxzL2VtYWlsSW52aXRlL2VtYWlsSW52aXRlLmNvbnRyb2xsZXIuanMiLCJtb2RhbHMvbG9naW4vbG9naW4uY29udHJvbGxlci5qcyIsIm1vZGFscy9sb2dvdXQvbG9nb3V0LmNvbnRyb2xsZXIuanMiLCJtb2RhbHMvbmV3Q2hhdC9uZXdDaGF0LmNvbnRyb2xsZXIuanMiLCJtb2RhbHMvcmVnaXN0ZXIvcmVnaXN0ZXIuY29udHJvbGxlci5qcyIsImNvbW1vbi9kaXJlY3RpdmVzL21haW5Gb290ZXIvbWFpbkZvb3Rlci5kaXJlY3RpdmUuanMiLCJjb21tb24vZGlyZWN0aXZlcy9tYWluTmF2aWdhdGlvbi9tYWluTmF2aWdhdGlvbi5kaXJlY3RpdmUuanMiLCJjb21tb24vZGlyZWN0aXZlcy9tZXNzYWdlRW50cnkvbWVzc2FnZUVudHJ5LmRpcmVjdGl2ZS5qcyJdLCJuYW1lcyI6WyJjb25maWciLCIkcm91dGVQcm92aWRlciIsIiRsb2NhdGlvblByb3ZpZGVyIiwiJHNvY2tldFByb3ZpZGVyIiwid2hlbiIsInRlbXBsYXRlVXJsIiwiY29udHJvbGxlciIsImNvbnRyb2xsZXJBcyIsIm90aGVyd2lzZSIsInJlZGlyZWN0VG8iLCJodG1sNU1vZGUiLCJlbmFibGVkIiwicmVxdWlyZUJhc2UiLCJwb3J0Iiwic2V0Q29ubmVjdGlvblVybCIsIndpbmRvdyIsImxvY2F0aW9uIiwiaG9zdG5hbWUiLCJhbmd1bGFyIiwibW9kdWxlIiwiY2hhdEN0cmwiLCIkc2NvcGUiLCIkcm91dGVQYXJhbXMiLCIkc29ja2V0IiwiJHVpYk1vZGFsIiwiZmlsZVJlYWRlciIsInZtIiwidGhpcyIsInNldFJvb21OYW1lIiwicm9vbWlkIiwic3BsaXQiLCJqb2luIiwiY2hhdE5hbWUiLCJhbGVydE1lc3NhZ2UiLCJtZXNzYWdlVGhyZWFkIiwidXNlcklkIiwibG9jYWxTdG9yYWdlIiwiZ2V0SXRlbSIsImNoYXRSb29tVXNlcnMiLCJvbiIsImlkIiwic2V0SXRlbSIsIm5hbWUiLCJuaWNrbmFtZSIsImRhdGEiLCJ1c2VybmFtZSIsIm1lc3NhZ2UiLCJjb250ZW50Iiwic2VsZkNsYXNzZXMiLCJzaG93Tmlja25hbWUiLCJzZW5kZXIiLCJwdXNoIiwiJCIsImFuaW1hdGUiLCJzY3JvbGxUb3AiLCJvZmZzZXQiLCJ0b3AiLCJzZW5kTWVzc2FnZSIsIm1lc3NhZ2VUb1NlbmQiLCJlbWl0IiwidXBsb2FkSW1hZ2UiLCJlbGVtZW50IiwicmVhZEltYWdlIiwiZW1pdEltYWdlIiwiZSIsInRhcmdldCIsInJlc3VsdCIsImNoYXROaWNrbmFtZVBvcHVwIiwib3BlbiIsImJhY2tkcm9wIiwia2V5Ym9hcmQiLCJyZXNvbHZlIiwiY2hhdFJvb21EYXRhIiwiZ2V0VXNlcnMiLCJ1c2VycyIsImVtYWlsSW52aXRlUG9wdXAiLCJtb2RhbEluc3RhbmNlIiwic2VuZGVySW5mbyIsImNoYXRVcmwiLCJocmVmIiwidGhlbiIsImFsZXJ0Iiwic2VuZE1lc3NhZ2VBQ0siLCJkYXRhVG9TZW5kIiwic2VydmVyUmVzcG9uc2VBQ0siLCIkaW5qZWN0IiwiY29udGFjdERldGFpbEN0cmwiLCIkaHR0cCIsImNvbnN0YW50cyIsImRldGFpbFVybCIsImFwaVVybCIsImNvbnRhY3RpZCIsIm1ldGhvZCIsInVybCIsImhlYWRlcnMiLCJBdXRob3JpemF0aW9uIiwicmVzcG9uc2UiLCJjb250YWN0IiwiY29uc29sZSIsImxvZyIsIm9uQ2xpY2tCYWNrIiwiY29udGFjdHNDdHJsIiwiYWNjb3VudGlkIiwiYWNjb3VudE5hbWUiLCJjb250YWN0c1VybCIsImhhc0NvbnRhY3RzIiwiY29udGFjdHMiLCJsZW5ndGgiLCJpIiwiY29udmVyc2F0aW9uVXJsIiwiZ2V0TGF0ZXN0TWVzc2FnZSIsImluZGV4IiwidGhyZWFkVXJsIiwibGF0ZXN0TWVzc2FnZSIsImFkZENvbnRhY3RQb3B1cCIsImNvbnZlcnNhdGlvbkN0cmwiLCJjb250YWN0TmFtZSIsInNob3J0TmFtZSIsIm5ld01lc3NhZ2VVcmwiLCJzZW5kZXJfYWNjb3VudCIsInNjcm9sbFRvRW5kIiwic29ydGVkSWRzIiwic29ydCIsImEiLCJiIiwiY29udmVyc2F0aW9uIiwiZW1pdEFuZFBvc3RNZXNzYWdlIiwicmVjaXBpZW50X2FjY291bnQiLCJzZW5kSW1hZ2UiLCJob21lQ3RybCIsIm5ld0NoYXRQb3B1cCIsInJlZ2lzdHJhdGlvblBvcHVwIiwibG9naW5Qb3B1cCIsImNoYXRIb21lQ3RybCIsInBhZ2VUaXRsZSIsImhpc3RvcnkiLCJiYWNrIiwic2VydmljZSIsImN1cnJlbnRUaW1lIiwiZ2V0VGltZSIsIkRhdGUiLCJub3ciLCJjYWxsYmFjayIsIiRhcHBseSIsInNjb3BlIiwiaW1hZ2UiLCJmaWxlcyIsImlzSW1hZ2UiLCJ0eXBlIiwic2VhcmNoIiwicmVhZGVyIiwiRmlsZVJlYWRlciIsIm9ubG9hZCIsInJlYWRBc0RhdGFVUkwiLCJwcmV0dGlmeU1lc3NhZ2UiLCJsaW5raWZ5IiwibGlua3MiLCJjb250YWluc0xpbmsiLCJzcGxpdE1lc3NhZ2UiLCJsaW5rVGV4dCIsImxpbmtVcmwiLCJjaGFyYWN0ZXJzIiwiaiIsImVuZHNXaXRoIiwic3BsaXRMaW5rIiwicG9wIiwiZGlzcGxheUltYWdlcyIsIm51bUxpbmtzIiwibCIsInNwbGljZSIsImRpc3BsYXlCYXNlNjQiLCJsaW5rZWQiLCJpbWFnZWQiLCJmaWx0ZXIiLCJhZGRDb250YWN0Q3RybCIsIiR1aWJNb2RhbEluc3RhbmNlIiwic2VhcmNoVXJsIiwiY3JlYXRlVXJsIiwiZm91bmRDb250YWN0cyIsIm51bVNlbGVjdGVkIiwiZ2V0U2VsZWN0ZWQiLCJzZWxlY3RlZCIsImFkZGVkIiwicXVlcnlLZXlVcCIsImZvcm1EYXRhIiwicXVlcnkiLCJzZWxlY3RDb250YWN0IiwiY2xpY2tBZGQiLCJhZGRlcl9pZCIsImFkZGVkX2lkIiwiY2xvc2UiLCJjbG9zZU1vZGFsIiwiY2hhdE5pY2tuYW1lQ3RybCIsIm9uU3VibWl0IiwiZm9ybUVycm9yIiwiam9pblJvb20iLCJlbWFpbEludml0ZUN0cmwiLCJvbkNsaWNrU2VuZCIsInJlY2lwaWVudE5hbWUiLCJyZWNpcGllbnRFbWFpbCIsInNlbmRNYWlsIiwibWFpbERhdGEiLCJwb3N0Iiwib25DbGlja0NhbmNlbCIsInRlc3RGdW5jdGlvbiIsImxvZ2luQ3RybCIsIiRsb2NhdGlvbiIsImxvZ2luVXJsIiwib25DbGlja0xvZ2luIiwiZW1haWwiLCJwYXNzd29yZCIsImF1dGhfdG9rZW4iLCJhY2NvdW50IiwiY29udGFjdHNQYWdlIiwicGF0aCIsImVycm9ycyIsImxvZ291dEN0cmwiLCJvbkNvbmZpcm1Mb2dvdXQiLCJjbGVhciIsIm5ld0NoYXRDdHJsIiwicm9vbU5hbWUiLCJyZWdpc3RlckN0cmwiLCJyZWdpc3RlclVybCIsIm9uQ2xpY2tSZWdpc3RlciIsInByb2ZpbGVJbWFnZSIsInNldFByb2ZpbGVJbWFnZSIsIm1haW5Gb290ZXIiLCJyZXN0cmljdCIsImxpbmsiLCJ0b2RheXNEYXRlIiwiZGlyZWN0aXZlIiwibWFpbk5hdmln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QTNCQXhLLEVBQUF3SyxVQUFBLHdDQWdDQSxHQUdBN0ssRUFBQXVDLFlBQUEsU0FBQUMsR0FDQXBDLEVBQUFxQyxVQUFBRCxFQUFBbkMsRUFBQXVNLGdCQUFBNU0sSUFHQUssRUFBQXVNLGdCQUFBLFNBQUFqSyxHQUNBLEdBQUFpRixHQUFBakYsRUFBQUMsT0FBQUMsTUFDQStFLElBRUE1SCxFQUFBMEgsT0FBQSxXQUNBckgsRUFBQXNNLGFBQUEvRSxLQUtBdkgsRUFBQWlMLGNBQUEsV0FDQTVCLEVBQUFlLFNBL0RBNUssUUFDQUMsT0FBQSxnQkFDQWIsV0FBQSxlQUFBdU4sR0FFQUEsRUFBQXhJLFNBQUEsb0JBQUEsUUFBQSxZQUFBLFNBQUEsYUFBQSxnQkNMQSxXQU1BLFFBQUE2SSxHQUFBeEYsR0FFQSxPQUNBeUYsU0FBQSxLQUNBbkYsU0FDQW9GLEtBQUEsU0FBQXBGLEdBQ0FBLEVBQUFxRixXQUFBM0YsRUFBQUcsS0FFQXhJLFlBQUEsMERBYkFhLFFBQ0FDLE9BQUEsZ0JBQ0FtTixVQUFBLGNBQUEsY0FBQUosSUFFQUEsRUFBQTdJLFNBQUEsa0JDTEEsV0FNQSxRQUFBa0osR0FBQS9NLEdBQ0EsR0FBQWdOLEdBQUEsV0FDQXRJLFFBQUFDLElBQUEsVUFDQTNFLEdBQUE0QyxNQUNBL0QsWUFBQSxrQ0FDQUMsV0FBQSxxQkFHQSxRQUNBNk4sU0FBQSxLQUNBOU4sWUFBQSxpRUFDQStOLEtBQUEsU0FBQXBGLEdBQ0FBLEVBQUF3RixjQUFBQSxFQUNBeEYsRUFBQXlGLFNBQUFyTSxhQUFBQyxRQUFBLGNBbEJBbkIsUUFDQUMsT0FBQSxnQkFDQW1OLFVBQUEsaUJBQUFDLEdBRUFBLEVBQUFsSixTQUFBLGdCQ0xBLFdBS0EsUUFBQXFKLEtBQ0EsT0FDQVAsU0FBQSxLQUNBUSxRQUFBLFVBQ0F0TyxZQUFBLDhEQVJBYSxRQUNBQyxPQUFBLGdCQUNBbU4sVUFBQSxlQUFBSSIsImZpbGUiOiJ3ZW1lc3NhZ2UubWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsiKGZ1bmN0aW9uKCkge1xuICBhbmd1bGFyLm1vZHVsZSgnd2VNZXNzYWdlQXBwJywgWyduZ1JvdXRlJywgJ25nU2FuaXRpemUnLCAnc29ja2V0LmlvJywgJ3VpLmJvb3RzdHJhcCddKTtcblxuICBmdW5jdGlvbiBjb25maWcoJHJvdXRlUHJvdmlkZXIsICRsb2NhdGlvblByb3ZpZGVyLCAkc29ja2V0UHJvdmlkZXIpIHtcbiAgICAkcm91dGVQcm92aWRlclxuICAgICAgLndoZW4oJy8nLCB7XG4gICAgICAgIHRlbXBsYXRlVXJsOiAnaG9tZS9ob21lLnZpZXcuaHRtbCcsXG4gICAgICAgIGNvbnRyb2xsZXI6ICdob21lQ3RybCcsXG4gICAgICAgIGNvbnRyb2xsZXJBczogJ3ZtJ1xuICAgICAgfSlcbiAgICAgIC53aGVuKCcvY2hhdC86cm9vbWlkJywge1xuICAgICAgICB0ZW1wbGF0ZVVybDogJy9jaGF0L2NoYXQudmlldy5odG1sJyxcbiAgICAgICAgY29udHJvbGxlcjogJ2NoYXRDdHJsJyxcbiAgICAgICAgY29udHJvbGxlckFzOiAndm0nXG4gICAgICB9KVxuICAgICAgLndoZW4oJy9jb250YWN0cycsIHtcbiAgICAgICAgdGVtcGxhdGVVcmw6ICcvY29udGFjdHMvY29udGFjdHMudmlldy5odG1sJyxcbiAgICAgICAgY29udHJvbGxlcjogJ2NvbnRhY3RzQ3RybCcsXG4gICAgICAgIGNvbnRyb2xsZXJBczogJ3ZtJ1xuICAgICAgfSlcbiAgICAgIC53aGVuKCcvYWNjb3VudC86YWNjb3VudGlkL3RocmVhZC86Y29udGFjdE5hbWUvOmNvbnRhY3RpZCcsIHtcbiAgICAgICAgdGVtcGxhdGVVcmw6ICcvY29udmVyc2F0aW9uL2NvbnZlcnNhdGlvbi52aWV3Lmh0bWwnLFxuICAgICAgICBjb250cm9sbGVyOiAnY29udmVyc2F0aW9uQ3RybCcsXG4gICAgICAgIGNvbnRyb2xsZXJBczogJ3ZtJ1xuICAgICAgfSlcbiAgICAgIC53aGVuKCcvYWNjb3VudC1pbmZvLzpjb250YWN0aWQnLCB7XG4gICAgICAgIHRlbXBsYXRlVXJsOiAnL2NvbnRhY3REZXRhaWwvY29udGFjdERldGFpbC52aWV3Lmh0bWwnLFxuICAgICAgICBjb250cm9sbGVyOiAnY29udGFjdERldGFpbEN0cmwnLFxuICAgICAgICBjb250cm9sbGVyQXM6ICd2bSdcbiAgICAgIH0pXG4gICAgICAud2hlbignL2NoYXQtaG9tZScsIHtcbiAgICAgICAgdGVtcGxhdGVVcmw6ICcvc3RhdGljL3N0YXRpYy52aWV3Lmh0bWwnLFxuICAgICAgICBjb250cm9sbGVyOiAnY2hhdEhvbWVDdHJsJyxcbiAgICAgICAgY29udHJvbGxlckFzOiAndm0nXG4gICAgICB9KVxuICAgICAgLm90aGVyd2lzZSh7cmVkaXJlY3RUbzogJy8nfSk7XG4gICAgJGxvY2F0aW9uUHJvdmlkZXIuaHRtbDVNb2RlKHtcbiAgICAgIGVuYWJsZWQ6IHRydWUsXG4gICAgICByZXF1aXJlQmFzZTogZmFsc2VcbiAgICB9KTtcbiAgICB2YXIgcG9ydCA9ICc6ODA4MCc7XG4gICAgJHNvY2tldFByb3ZpZGVyLnNldENvbm5lY3Rpb25Vcmwod2luZG93LmxvY2F0aW9uLmhvc3RuYW1lICsgcG9ydCk7XG4gIH1cblxuICBhbmd1bGFyXG4gICAgLm1vZHVsZSgnd2VNZXNzYWdlQXBwJylcbiAgICAuY29uZmlnKFsnJHJvdXRlUHJvdmlkZXInLCAnJGxvY2F0aW9uUHJvdmlkZXInLCAnJHNvY2tldFByb3ZpZGVyJywgY29uZmlnXSk7XG59KSgpO1xuIiwiKGZ1bmN0aW9uKCkge1xuICBhbmd1bGFyXG4gICAgLm1vZHVsZSgnd2VNZXNzYWdlQXBwJylcbiAgICAuY29udHJvbGxlcignY2hhdEN0cmwnLCBjaGF0Q3RybCk7XG5cbiAgY2hhdEN0cmwuJGluamVjdCA9IFsnJHNjb3BlJywgJyRyb3V0ZVBhcmFtcycsICckc29ja2V0JywgJyR1aWJNb2RhbCcsICdmaWxlUmVhZGVyJ107XG4gIGZ1bmN0aW9uIGNoYXRDdHJsKCRzY29wZSwgJHJvdXRlUGFyYW1zLCAkc29ja2V0LCAkdWliTW9kYWwsIGZpbGVSZWFkZXIpIHtcbiAgICB2YXIgdm0gPSB0aGlzO1xuXG4gICAgdm0uc2V0Um9vbU5hbWUgPSBmdW5jdGlvbihyb29taWQpIHtcbiAgICAgIHJvb21pZCA9IHJvb21pZC5zcGxpdCgnLScpLmpvaW4oJyAnKTtcbiAgICAgIHJldHVybiByb29taWQuc3BsaXQoJ18nKS5qb2luKCcgJyk7XG4gICAgfVxuXG4gICAgdm0ucm9vbWlkID0gJHJvdXRlUGFyYW1zLnJvb21pZDtcbiAgICB2bS5jaGF0TmFtZSA9IHZtLnNldFJvb21OYW1lKHZtLnJvb21pZCkgfHwgJ0luc3RhbnQgQ2hhdCc7XG4gICAgdm0uYWxlcnRNZXNzYWdlID0gJyc7XG4gICAgdm0ubWVzc2FnZVRocmVhZCA9IHZtLm1lc3NhZ2VUaHJlYWQgfHwgW107XG4gICAgLy8gdm0ubmlja25hbWUgPSB2bS5uaWNrbmFtZSB8fCBsb2NhbFN0b3JhZ2Uubmlja25hbWUgfHwgJyc7XG4gICAgdm0udXNlcklkID0gdm0udXNlcklkIHx8IGxvY2FsU3RvcmFnZS5nZXRJdGVtKCd1c2VySWQnKSB8fCAnJztcbiAgICAvLyB2bS5uaWNrbmFtZSA9ICcnO1xuICAgIHZtLmNoYXRSb29tVXNlcnMgPSBbXTtcblxuICAgIC8vIHNldCB1c2VyIGlkIG9uIGNvbm5lY3RcbiAgICAkc29ja2V0Lm9uKCdzZXQtaWQnLCBmdW5jdGlvbihpZCkge1xuICAgICAgdm0udXNlcklkID0gaWQ7XG4gICAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbSgndXNlcklkJywgaWQpO1xuICAgIH0pO1xuXG4gICAgJHNvY2tldC5vbignbmlja25hbWUtc2V0JywgZnVuY3Rpb24obmFtZSkge1xuICAgICAgdm0ubmlja25hbWUgPSBuYW1lO1xuICAgICAgbG9jYWxTdG9yYWdlLm5pY2tuYW1lID0gbmFtZTtcbiAgICB9KTtcblxuICAgIC8vIGRpc3BsYXkgbWVzc2FnZXMgYXMgdGhleSBjb21lIGluXG4gICAgJHNvY2tldC5vbignY2hhdHJvb20tbWVzc2FnZScsIGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAvLyBnZXQgbWVzc2FnZSBkYXRhIGZyb20gc29ja2V0IGV2ZW50XG4gICAgICB2YXIgbmlja25hbWUgPSBkYXRhLnVzZXJuYW1lIHx8IHZtLm5pY2tuYW1lIHx8ICcnO1xuICAgICAgdmFyIG1lc3NhZ2UgPSB7XG4gICAgICAgIGNvbnRlbnQ6IGRhdGEubWVzc2FnZSxcbiAgICAgICAgc2VsZkNsYXNzZXM6ICcnLFxuICAgICAgICBzaG93Tmlja25hbWU6IHRydWUsXG4gICAgICAgIHVzZXJuYW1lOiBuaWNrbmFtZVxuICAgICAgfTtcbiAgICAgIC8vIGFsdGVyIGxheW91dCBpZiBtZXNzYWdlIHdhcyBzZW50IGJ5IHRoaXMgdXNlclxuICAgICAgaWYodm0udXNlcklkID09IGRhdGEuc2VuZGVyKSB7XG4gICAgICAgIG1lc3NhZ2Uuc2VsZkNsYXNzZXMgPSAnc2VsZi1zZW50IHRleHQtcmlnaHQnO1xuICAgICAgICBtZXNzYWdlLnNob3dOaWNrbmFtZSA9IGZhbHNlO1xuICAgICAgLy8gYWx0ZXIgbGF5b3V0IGlmIGl0J3MgYSBzeXN0ZW0gbWVzc2FnZVxuICAgICAgfSBlbHNlIGlmKGRhdGEuc2VuZGVyID09ICd0aGUgc29ja2V0IG1hc3RlcicpIHtcbiAgICAgICAgbWVzc2FnZS5zZWxmQ2xhc3NlcyA9ICdib2xkIHRleHQtY2VudGVyJztcbiAgICAgICAgbWVzc2FnZS5zaG93Tmlja25hbWUgPSBmYWxzZTtcbiAgICAgIH1cbiAgICAgIC8vIGRpc3BsYXkgdGhlIG1lc3NhZ2VcbiAgICAgIHZtLm1lc3NhZ2VUaHJlYWQucHVzaChtZXNzYWdlKTtcbiAgICAgIC8vIHNjcm9sbCB0byB0aGUgYm90dG9tIG9mIHRoZSBtZXNzYWdlIHRocmVhZFxuICAgICAgLy8galF1ZXJ5IC0gYmVjYXVzZSBhbmNob3JTY3JvbGwgIT0gJ2NsZWFuJ1xuICAgICAgJCgnaHRtbCwgYm9keScpLmFuaW1hdGUoe1xuICAgICAgICBzY3JvbGxUb3A6ICQoJyNtZXNzYWdlLWlucHV0LWFuY2hvcicpLm9mZnNldCgpLnRvcFxuICAgICAgfSwgJ3Nsb3cnKTtcbiAgICB9KTtcblxuICAgIC8vIHNlbmQgbWVzc2FnZSBvbiBzdWJtaXRcbiAgICB2bS5zZW5kTWVzc2FnZSA9IGZ1bmN0aW9uIHNlbmRNZXNzYWdlKCkge1xuICAgICAgaWYodm0ubWVzc2FnZVRvU2VuZCkge1xuICAgICAgICAkc29ja2V0LmVtaXQoJ2NoYXRyb29tLW1lc3NhZ2UnLCB2bS5tZXNzYWdlVG9TZW5kKTtcbiAgICAgICAgdm0ubWVzc2FnZVRvU2VuZCA9ICcnO1xuICAgICAgfVxuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH07XG5cbiAgICAvLyBXb3JrYXJvdW5kIGJlY2F1c2UgQW5ndWxhciBkb2Vzbid0IHlldCBzdXBwb3J0IGZpbGUgaW5wdXQgY2hhbmdlIGV2ZW50XG4gICAgJHNjb3BlLnVwbG9hZEltYWdlID0gZnVuY3Rpb24oZWxlbWVudCkge1xuICAgICAgZmlsZVJlYWRlci5yZWFkSW1hZ2UoZWxlbWVudCwgdm0uZW1pdEltYWdlLCAkc2NvcGUpO1xuICAgIH1cblxuICAgIHZtLmVtaXRJbWFnZSA9IGZ1bmN0aW9uKGUpIHtcbiAgICAgICRzb2NrZXQuZW1pdCgnY2hhdHJvb20tbWVzc2FnZScsIGUudGFyZ2V0LnJlc3VsdCk7XG4gICAgfVxuXG4gICAgdm0uY2hhdE5pY2tuYW1lUG9wdXAgPSBmdW5jdGlvbigpIHtcbiAgICAgIHZhciBtb2RhbEluc3RhbmNlID0gJHVpYk1vZGFsLm9wZW4oe1xuICAgICAgICBiYWNrZHJvcDogJ3N0YXRpYycsXG4gICAgICAgIGtleWJvYXJkOiBmYWxzZSxcbiAgICAgICAgdGVtcGxhdGVVcmw6ICcvbW9kYWxzL2NoYXROaWNrbmFtZS9jaGF0Tmlja25hbWUudmlldy5odG1sJyxcbiAgICAgICAgY29udHJvbGxlcjogJ2NoYXROaWNrbmFtZUN0cmwgYXMgdm0nLFxuICAgICAgICByZXNvbHZlOiB7XG4gICAgICAgICAgY2hhdFJvb21EYXRhIDogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICByb29taWQgOiB2bS5yb29taWRcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9O1xuXG4gICAgaWYoIXZtLm5pY2tuYW1lKSB7XG4gICAgICB2bS5jaGF0Tmlja25hbWVQb3B1cCgpO1xuICAgIH1cblxuICAgIHZtLmdldFVzZXJzID0gZnVuY3Rpb24gZ2V0VXNlcnMoKSB7XG4gICAgICAkc29ja2V0LmVtaXQoJ3JlcXVlc3Qtc29ja2V0cy1pbi1yb29tJyk7XG4gICAgfVxuXG4gICAgJHNvY2tldC5vbignZGVsaXZlci1zb2NrZXRzLWluLXJvb20nLCBmdW5jdGlvbih1c2Vycykge1xuICAgICAgdm0uY2hhdFJvb21Vc2VycyA9IHVzZXJzO1xuICAgIH0pXG5cbiAgICB2bS5lbWFpbEludml0ZVBvcHVwID0gZnVuY3Rpb24oKSB7XG4gICAgICB2YXIgbW9kYWxJbnN0YW5jZSA9ICR1aWJNb2RhbC5vcGVuKHtcbiAgICAgICAgdGVtcGxhdGVVcmw6ICcvbW9kYWxzL2VtYWlsSW52aXRlL2VtYWlsSW52aXRlLnZpZXcuaHRtbCcsXG4gICAgICAgIGNvbnRyb2xsZXI6ICdlbWFpbEludml0ZUN0cmwgYXMgdm0nLFxuICAgICAgICByZXNvbHZlOiB7XG4gICAgICAgICAgc2VuZGVySW5mbyA6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgc2VuZGVyIDogdm0ubmlja25hbWUsXG4gICAgICAgICAgICAgIGNoYXRVcmwgOiB3aW5kb3cubG9jYXRpb24uaHJlZlxuICAgICAgICAgICAgfTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgICAgbW9kYWxJbnN0YW5jZS5yZXN1bHQudGhlbihmdW5jdGlvbihtZXNzYWdlKSB7XG4gICAgICAgIGlmKG1lc3NhZ2UpIHtcbiAgICAgICAgICB2YXIgYWxlcnQgPSB7XG4gICAgICAgICAgICBjb250ZW50OiBtZXNzYWdlLFxuICAgICAgICAgICAgc2VsZkNsYXNzZXM6ICdib2xkIHRleHQtY2VudGVyJyxcbiAgICAgICAgICAgIHNob3dOaWNrbmFtZTogZmFsc2UsXG4gICAgICAgICAgICB1c2VybmFtZTogJydcbiAgICAgICAgICB9O1xuICAgICAgICAgIHZtLm1lc3NhZ2VUaHJlYWQucHVzaChhbGVydCk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH07XG5cbiAgICAvLyBlY2hvLWFjaywgbm90IGN1cnJlbnRseSBpbiB1c2VcbiAgICB2bS5zZW5kTWVzc2FnZUFDSyA9IGZ1bmN0aW9uIHNlbmRNZXNzYWdlQUNLKCkge1xuICAgICAgJHNvY2tldC5lbWl0KCdlY2hvLWFjaycsIHZtLmRhdGFUb1NlbmQsIGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgdm0uc2VydmVyUmVzcG9uc2VBQ0sgPSBkYXRhO1xuICAgICAgfSk7XG4gICAgICB2bS5kYXRhVG9TZW5kID0gJyc7XG4gICAgfTtcblxuICB9O1xufSkoKTtcbiIsIihmdW5jdGlvbigpIHtcbiAgYW5ndWxhclxuICAgIC5tb2R1bGUoJ3dlTWVzc2FnZUFwcCcpXG4gICAgLmNvbnRyb2xsZXIoJ2NvbnRhY3REZXRhaWxDdHJsJywgY29udGFjdERldGFpbEN0cmwpO1xuXG4gICAgY29udGFjdERldGFpbEN0cmwuJGluamVjdCA9IFsnJHNjb3BlJywgJyRyb3V0ZVBhcmFtcycsICckaHR0cCcsICdjb25zdGFudHMnXTtcbiAgICBmdW5jdGlvbiBjb250YWN0RGV0YWlsQ3RybCgkc2NvcGUsICRyb3V0ZVBhcmFtcywgJGh0dHAsIGNvbnN0YW50cykge1xuICAgICAgdmFyIHZtID0gdGhpcztcbiAgICAgIHZtLmRldGFpbFVybCA9IGNvbnN0YW50cy5hcGlVcmwgKyAnL2FjY291bnQvJyArICRyb3V0ZVBhcmFtcy5jb250YWN0aWQ7XG4gICAgICAkaHR0cCh7XG4gICAgICAgIG1ldGhvZDogJ0dFVCcsXG4gICAgICAgIHVybDogdm0uZGV0YWlsVXJsLFxuICAgICAgICBoZWFkZXJzOiB7XG4gICAgICAgICAgJ0F1dGhvcml6YXRpb24nOiAnQmVhcmVyICcgKyBsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgnYXV0aFRva2VuJylcbiAgICAgICAgfVxuICAgICAgfSlcbiAgICAgIC50aGVuKGZ1bmN0aW9uIHN1Y2Nlc3NDYWxsYmFjayhyZXNwb25zZSkge1xuICAgICAgICB2bS5jb250YWN0ID0gcmVzcG9uc2UuZGF0YTtcbiAgICAgIH0sIGZ1bmN0aW9uIGVycm9yQ2FsbGJhY2socmVzcG9uc2UpIHtcbiAgICAgICAgY29uc29sZS5sb2cocmVzcG9uc2UpO1xuICAgICAgfSk7XG4gICAgICB2bS5vbkNsaWNrQmFjayA9IGNvbnN0YW50cy5vbkNsaWNrQmFjaztcbiAgICB9XG59KSgpO1xuIiwiKGZ1bmN0aW9uKCkge1xuICBhbmd1bGFyXG4gICAgLm1vZHVsZSgnd2VNZXNzYWdlQXBwJylcbiAgICAuY29udHJvbGxlcignY29udGFjdHNDdHJsJywgY29udGFjdHNDdHJsKTtcblxuICBjb250YWN0c0N0cmwuJGluamVjdCA9IFsnJHNjb3BlJywgJyRodHRwJywgJyR1aWJNb2RhbCcsICdjb25zdGFudHMnXTtcbiAgZnVuY3Rpb24gY29udGFjdHNDdHJsKCRzY29wZSwgJGh0dHAsICR1aWJNb2RhbCwgY29uc3RhbnRzKSB7XG4gICAgdmFyIHZtID0gdGhpcztcblxuICAgIHZtLmFjY291bnRpZCA9IGxvY2FsU3RvcmFnZS5nZXRJdGVtKCdhY2NvdW50aWQnKTtcbiAgICB2bS5hY2NvdW50TmFtZSA9IGxvY2FsU3RvcmFnZS5nZXRJdGVtKCdhY2NvdW50TmFtZScpO1xuICAgIHZtLmFsZXJ0TWVzc2FnZSA9ICcnO1xuICAgIHZtLmFwaVVybCA9IGNvbnN0YW50cy5hcGlVcmw7XG4gICAgdm0uY29udGFjdHNVcmwgPSB2bS5hcGlVcmwgKyAnL2FjY291bnQtY29udGFjdHMnO1xuICAgIHZtLmhhc0NvbnRhY3RzID0gdHJ1ZTtcbiAgICAvLyBHZXQgY29udGFjdCBsaXN0IGZvciB0aGlzIGFjY291bnRcbiAgICAkaHR0cCh7XG4gICAgICBtZXRob2Q6ICdHRVQnLFxuICAgICAgdXJsOiB2bS5jb250YWN0c1VybCxcbiAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgICdBdXRob3JpemF0aW9uJzogJ0JlYXJlciAnICsgbG9jYWxTdG9yYWdlLmdldEl0ZW0oJ2F1dGhUb2tlbicpXG4gICAgICAgfSxcbiAgICB9KVxuICAgIC50aGVuKGZ1bmN0aW9uIHN1Y2Nlc3NDYWxsYmFjayhyZXNwb25zZSkge1xuICAgICAgdm0uY29udGFjdHMgPSByZXNwb25zZS5kYXRhO1xuICAgICAgaWYodm0uY29udGFjdHMgJiYgdm0uY29udGFjdHMubGVuZ3RoID4gMCkge1xuICAgICAgICB2bS5oYXNDb250YWN0cyA9IHRydWU7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB2bS5oYXNDb250YWN0cyA9IGZhbHNlO1xuICAgICAgfVxuICAgICAgZm9yKHZhciBpPSAwOyBpIDwgdm0uY29udGFjdHMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgdmFyIGlkID0gdm0uY29udGFjdHNbaV0uaWRcbiAgICAgICAgdm0uY29udGFjdHNbaV0uY29udmVyc2F0aW9uVXJsID0gJy9hY2NvdW50LycgKyB2bS5hY2NvdW50aWQgKyAnL3RocmVhZC8nICsgdm0uY29udGFjdHNbaV0ubmFtZSArICcvJyArIGlkXG4gICAgICAgIHZhciBsYXRlc3QgPSB2bS5nZXRMYXRlc3RNZXNzYWdlKGlkLCBpKTtcbiAgICAgIH1cbiAgICB9LCBmdW5jdGlvbiBlcnJvckNhbGxiYWNrKHJlc3BvbnNlKSB7XG4gICAgICB2bS5oYXNDb250YWN0cyA9IGZhbHNlO1xuICAgICAgY29uc29sZS5sb2cocmVzcG9uc2UpO1xuICAgIH0pO1xuXG4gICAgdm0uZ2V0TGF0ZXN0TWVzc2FnZSA9IGZ1bmN0aW9uKGNvbnRhY3RpZCwgaW5kZXgpIHtcbiAgICAgIHZhciB0aHJlYWRVcmwgPSB2bS5hcGlVcmwgKyAnL21lc3NhZ2VzL3NlbmRlci8nICsgdm0uYWNjb3VudGlkICsgJy9yZWNpcGllbnQvJyArIGNvbnRhY3RpZCArICcvbGF0ZXN0JztcbiAgICAgICRodHRwKHtcbiAgICAgICAgbWV0aG9kOiAnR0VUJyxcbiAgICAgICAgdXJsOiB0aHJlYWRVcmwsXG4gICAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgICAgJ0F1dGhvcml6YXRpb24nOiAnQmVhcmVyICcgKyBsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgnYXV0aFRva2VuJylcbiAgICAgICAgIH1cbiAgICAgIH0pXG4gICAgICAudGhlbihmdW5jdGlvbiBzdWNjZXNzQ2FsbGJhY2socmVzcG9uc2UpIHtcbiAgICAgICAgaWYocmVzcG9uc2UuZGF0YSkge1xuICAgICAgICAgIHZtLmNvbnRhY3RzW2luZGV4XS5sYXRlc3RNZXNzYWdlID0gcmVzcG9uc2UuZGF0YTtcbiAgICAgICAgfVxuICAgICAgfSwgZnVuY3Rpb24gZXJyb3JDYWxsYmFjayhyZXNwb25zZSkge1xuICAgICAgICBjb25zb2xlLmxvZyhyZXNwb25zZSk7XG4gICAgICB9KTtcbiAgICB9O1xuXG4gICAgdm0ub25DbGlja0JhY2sgPSBjb25zdGFudHMub25DbGlja0JhY2s7XG5cbiAgICAvLyBUTyBETzogU2V0IHVwIG5ldyBlbWFpbCBpbnZpdGUgZm9yIGludml0aW5nIHRvIGpvaW4gV2VNZXNzYWdlXG4gICAgLy8gKHRoaXMgb25lIGludml0ZXMgdG8gYSBjaGF0cm9vbSlcbiAgICB2bS5hZGRDb250YWN0UG9wdXAgPSBmdW5jdGlvbigpIHtcbiAgICAgIHZhciBtb2RhbEluc3RhbmNlID0gJHVpYk1vZGFsLm9wZW4oe1xuICAgICAgICB0ZW1wbGF0ZVVybDogJy9tb2RhbHMvYWRkQ29udGFjdC9hZGRDb250YWN0LnZpZXcuaHRtbCcsXG4gICAgICAgIGNvbnRyb2xsZXI6ICdhZGRDb250YWN0Q3RybCBhcyB2bScsXG4gICAgICB9KTtcbiAgICAgIG1vZGFsSW5zdGFuY2UucmVzdWx0LnRoZW4oZnVuY3Rpb24oY29udGFjdCkge1xuICAgICAgICBpZihjb250YWN0LmlkKSB7XG4gICAgICAgICAgY29udGFjdC5jb252ZXJzYXRpb25VcmwgPSAnL2FjY291bnQvJyArIHZtLmFjY291bnRpZCArICcvdGhyZWFkLycgKyBjb250YWN0Lm5hbWUgKyAnLycgKyBjb250YWN0LmlkO1xuICAgICAgICAgIHZtLmhhc0NvbnRhY3RzID0gdHJ1ZTtcbiAgICAgICAgICB2bS5jb250YWN0cy5wdXNoKGNvbnRhY3QpO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9O1xuXG4gIH07XG59KSgpO1xuIiwiKGZ1bmN0aW9uKCkge1xuICBhbmd1bGFyXG4gICAgLm1vZHVsZSgnd2VNZXNzYWdlQXBwJylcbiAgICAuY29udHJvbGxlcignY29udmVyc2F0aW9uQ3RybCcsIGNvbnZlcnNhdGlvbkN0cmwpO1xuXG4gIGNvbnZlcnNhdGlvbkN0cmwuJGluamVjdCA9IFsnJHNjb3BlJywgJyRyb3V0ZVBhcmFtcycsICckc29ja2V0JywgJyRodHRwJywgJ2NvbnN0YW50cycsICdmaWxlUmVhZGVyJ107XG4gIGZ1bmN0aW9uIGNvbnZlcnNhdGlvbkN0cmwoJHNjb3BlLCAkcm91dGVQYXJhbXMsICRzb2NrZXQsICRodHRwLCBjb25zdGFudHMsIGZpbGVSZWFkZXIpIHtcbiAgICB2YXIgdm0gPSB0aGlzO1xuICAgIC8vIGFjY291bnRpZCByZWZlcnMgdG8gd2VtZXNzYWdlIGFjY291bnQgaWRcbiAgICAvLyB1c2VySWQgcmVmZXJzIHRvIHRlbXBvcmFyeSBpZCBzZXQgYnkgd2ViIHNvY2tldFxuICAgIHZtLmFjY291bnRpZCA9ICRyb3V0ZVBhcmFtcy5hY2NvdW50aWQ7XG4gICAgdm0udXNlcklkID0gdm0udXNlcklkIHx8IGxvY2FsU3RvcmFnZS5nZXRJdGVtKCd1c2VySWQnKSB8fCAnJztcbiAgICB2bS5jb250YWN0ID0ge1xuICAgICAgaWQ6ICRyb3V0ZVBhcmFtcy5jb250YWN0aWQsXG4gICAgICBuYW1lOiAkcm91dGVQYXJhbXMuY29udGFjdE5hbWUsXG4gICAgICBzaG9ydE5hbWU6ICRyb3V0ZVBhcmFtcy5jb250YWN0TmFtZS5zcGxpdCgnICcpWzBdLFxuICAgICAgdXJsOiAnL2FjY291bnQtaW5mby8nICsgJHJvdXRlUGFyYW1zLmNvbnRhY3RpZFxuICAgIH07XG4gICAgdm0udGhyZWFkVXJsID0gY29uc3RhbnRzLmFwaVVybCArICcvbWVzc2FnZXMvc2VuZGVyLycgKyB2bS5hY2NvdW50aWQgKyAnL3JlY2lwaWVudC8nICsgdm0uY29udGFjdC5pZDtcbiAgICB2bS5uZXdNZXNzYWdlVXJsID0gY29uc3RhbnRzLmFwaVVybCArICcvbWVzc2FnZXMvJztcblxuICAgIC8vIFN0b3JlIG5hbWUgaW4gbG9jYWxTdG9yYWdlIG9uIGxvZ2luLCByZXRyaWV2ZSBmcm9tIGxvY2FsU3RvcmFnZSBoZXJlXG4gICAgdm0uYWNjb3VudE5hbWUgPSBsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgnYWNjb3VudE5hbWUnKTtcblxuICAgIHZtLmFsZXJ0TWVzc2FnZSA9ICcnO1xuXG4gICAgdm0ubWVzc2FnZVRocmVhZCA9IFtdO1xuICAgIC8vIEdldCBtZXNzYWdlIHRocmVhZCBmb3IgdGhlIGxvZ2dlZCBpbiBhY2NvdW50IGFuZCB0aGlzIGNvbnRhY3RcbiAgICAkaHR0cCh7XG4gICAgICBtZXRob2Q6ICdHRVQnLFxuICAgICAgdXJsOiB2bS50aHJlYWRVcmwsXG4gICAgICBoZWFkZXJzOiB7XG4gICAgICAgICdBdXRob3JpemF0aW9uJzogJ0JlYXJlciAnICsgbG9jYWxTdG9yYWdlLmdldEl0ZW0oJ2F1dGhUb2tlbicpXG4gICAgICB9XG4gICAgfSlcbiAgICAudGhlbihmdW5jdGlvbiBzdWNjZXNzQ2FsbGJhY2socmVzcG9uc2UpIHtcbiAgICAgIHZtLm1lc3NhZ2VUaHJlYWQgPSByZXNwb25zZS5kYXRhO1xuICAgICAgaWYodm0ubWVzc2FnZVRocmVhZCkge1xuICAgICAgICBmb3IodmFyIGkgPSAwOyBpIDwgdm0ubWVzc2FnZVRocmVhZC5sZW5ndGg7IGkrKykge1xuICAgICAgICAgIC8vIHNldCBkaXNwbGF5IHN0eWxlIGZvciBtZXNzYWdlcyBzZW50IGZyb20gbG9nZ2VkIGluIHVzZXJcbiAgICAgICAgICBpZih2bS5tZXNzYWdlVGhyZWFkW2ldLnNlbmRlcl9hY2NvdW50ID09IHZtLmFjY291bnRpZCkge1xuICAgICAgICAgICAgdm0ubWVzc2FnZVRocmVhZFtpXS5zZWxmQ2xhc3NlcyA9ICdzZWxmLXNlbnQgdGV4dC1yaWdodCc7XG4gICAgICAgICAgICB2bS5tZXNzYWdlVGhyZWFkW2ldLnNob3dOaWNrbmFtZSA9IGZhbHNlO1xuICAgICAgICAgICAgLy8gc2V0IGRpc3BsYXkgc3R5bGUgZm9yIG1lc3NhZ2VzIGZyb20gY29udGFjdFxuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB2bS5tZXNzYWdlVGhyZWFkW2ldLnNob3dOaWNrbmFtZSA9IHRydWU7XG4gICAgICAgICAgICB2bS5tZXNzYWdlVGhyZWFkW2ldLnVzZXJuYW1lID0gdm0uY29udGFjdC5zaG9ydE5hbWU7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHZtLnNjcm9sbFRvRW5kKCk7XG4gICAgICB9XG4gICAgfSwgZnVuY3Rpb24gZXJyb3JDYWxsYmFjayhyZXNwb25zZSkge1xuICAgICAgY29uc29sZS5sb2cocmVzcG9uc2UpO1xuICAgIH0pO1xuXG4gICAgLy8gY3JlYXRlIHNvY2tldCByb29tIGlkIGZvciB0aGlzIGNvbnZlcnNhdGlvblxuICAgIHZhciBzb3J0ZWRJZHMgPSBbdm0uYWNjb3VudGlkLCB2bS5jb250YWN0LmlkXTtcbiAgICBzb3J0ZWRJZHMuc29ydChmdW5jdGlvbihhLCBiKSB7XG4gICAgICByZXR1cm4gYSAtIGI7XG4gICAgfSk7XG4gICAgdm0ucm9vbWlkID0gJ2NvbnZvLScgKyBzb3J0ZWRJZHNbMF0gKyAnLScgKyBzb3J0ZWRJZHNbMV07XG5cbiAgICAvLyBqb2luIHNvY2tldCBjaGF0cm9vbSB3aXRoIGNvbnRhY3RcbiAgICAkc29ja2V0LmVtaXQoJ2pvaW4tcm9vbScsIHtcbiAgICAgIHJvb21pZDogdm0ucm9vbWlkLFxuICAgICAgbmlja25hbWU6IHZtLmFjY291bnROYW1lLFxuICAgICAgY29udmVyc2F0aW9uOiB0cnVlXG4gICAgfSk7XG5cbiAgICAvLyBzZXQgdXNlciBpZCBvbiBjb25uZWN0XG4gICAgJHNvY2tldC5vbignc2V0LWlkJywgZnVuY3Rpb24oaWQpIHtcbiAgICAgIHZtLnVzZXJJZCA9IGlkO1xuICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oJ3VzZXJJZCcsIGlkKTtcbiAgICB9KTtcblxuICAgIC8vIGRpc3BsYXkgbWVzc2FnZXMgYXMgdGhleSBjb21lIGluXG4gICAgJHNvY2tldC5vbignY2hhdHJvb20tbWVzc2FnZScsIGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAvLyBnZXQgbWVzc2FnZSBkYXRhIGZyb20gc29ja2V0IGV2ZW50XG4gICAgICB2YXIgbmlja25hbWUgPSBkYXRhLnVzZXJuYW1lIHx8IHZtLm5pY2tuYW1lIHx8ICcnO1xuICAgICAgdmFyIG1lc3NhZ2UgPSB7XG4gICAgICAgIGNvbnRlbnQ6IGRhdGEubWVzc2FnZSxcbiAgICAgICAgc2VsZkNsYXNzZXM6ICcnLFxuICAgICAgICBzaG93Tmlja25hbWU6IHRydWUsXG4gICAgICAgIHVzZXJuYW1lOiBuaWNrbmFtZVxuICAgICAgfTtcbiAgICAgIC8vIGFsdGVyIGxheW91dCBpZiBtZXNzYWdlIHdhcyBzZW50IGJ5IHRoaXMgdXNlclxuICAgICAgaWYodm0udXNlcklkID09IGRhdGEuc2VuZGVyKSB7XG4gICAgICAgIG1lc3NhZ2Uuc2VsZkNsYXNzZXMgPSAnc2VsZi1zZW50IHRleHQtcmlnaHQnO1xuICAgICAgICBtZXNzYWdlLnNob3dOaWNrbmFtZSA9IGZhbHNlO1xuICAgICAgLy8gYWx0ZXIgbGF5b3V0IGlmIGl0J3MgYSBzeXN0ZW0gbWVzc2FnZVxuICAgICAgfSBlbHNlIGlmKGRhdGEuc2VuZGVyID09ICd0aGUgc29ja2V0IG1hc3RlcicpIHtcbiAgICAgICAgbWVzc2FnZS5zZWxmQ2xhc3NlcyA9ICdib2xkIHRleHQtY2VudGVyJztcbiAgICAgICAgbWVzc2FnZS5zaG93Tmlja25hbWUgPSBmYWxzZTtcbiAgICAgIH1cbiAgICAgIC8vIGRpc3BsYXkgdGhlIG1lc3NhZ2VcbiAgICAgIHZtLm1lc3NhZ2VUaHJlYWQucHVzaChtZXNzYWdlKTtcbiAgICAgIC8vIHNjcm9sbCB0byB0aGUgYm90dG9tIG9mIHRoZSBtZXNzYWdlIHRocmVhZFxuICAgICAgdm0uc2Nyb2xsVG9FbmQoKTtcbiAgICB9KTtcblxuICAgIC8vIHNlbmQgbWVzc2FnZSBvbiBzdWJtaXRcbiAgICB2bS5zZW5kTWVzc2FnZSA9IGZ1bmN0aW9uIHNlbmRNZXNzYWdlKCkge1xuICAgICAgaWYodm0ubWVzc2FnZVRvU2VuZCkge1xuICAgICAgICB2bS5lbWl0QW5kUG9zdE1lc3NhZ2Uodm0ubWVzc2FnZVRvU2VuZClcbiAgICAgIH1cbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9O1xuXG4gICAgdm0uZW1pdEFuZFBvc3RNZXNzYWdlID0gZnVuY3Rpb24gZW1pdEFuZFBvc3RNZXNzYWdlKG1lc3NhZ2UpIHtcbiAgICAgIC8vIHNlbmQgbWVzc2FnZSB0byBjb252ZXJzYXRpb24gY2hhdFxuICAgICAgJHNvY2tldC5lbWl0KCdjaGF0cm9vbS1tZXNzYWdlJywgbWVzc2FnZSk7XG4gICAgICAvLyBzdG9yZSBtZXNzYWdlIGluIHRoZSBkYXRhYmFzZVxuICAgICAgJGh0dHAoe1xuICAgICAgICBtZXRob2Q6ICdQT1NUJyxcbiAgICAgICAgdXJsOiB2bS5uZXdNZXNzYWdlVXJsLFxuICAgICAgICBkYXRhOiB7XG4gICAgICAgICAgc2VuZGVyX2FjY291bnQ6IHZtLmFjY291bnRpZCxcbiAgICAgICAgICByZWNpcGllbnRfYWNjb3VudDogdm0uY29udGFjdC5pZCxcbiAgICAgICAgICBjb250ZW50OiBtZXNzYWdlXG4gICAgICAgIH0sXG4gICAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgICAgJ0F1dGhvcml6YXRpb24nOiAnQmVhcmVyICcgKyBsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgnYXV0aFRva2VuJylcbiAgICAgICAgIH1cbiAgICAgIH0pXG4gICAgICAudGhlbihmdW5jdGlvbiBzdWNjZXNzQ2FsbGJhY2socmVzcG9uc2UpIHtcbiAgICAgICAgY29uc29sZS5sb2cocmVzcG9uc2UpO1xuICAgICAgfSwgZnVuY3Rpb24gZXJyb3JDYWxsYmFjayhyZXNwb25zZSkge1xuICAgICAgICBjb25zb2xlLmxvZyhyZXNwb25zZSk7XG4gICAgICB9KTtcbiAgICAgIHZtLm1lc3NhZ2VUb1NlbmQgPSAnJztcbiAgICB9XG5cbiAgICAvLyBXb3JrYXJvdW5kIGJlY2F1c2UgQW5ndWxhciBkb2Vzbid0IHlldCBzdXBwb3J0IGZpbGUgaW5wdXQgY2hhbmdlIGV2ZW50XG4gICAgJHNjb3BlLnVwbG9hZEltYWdlID0gZnVuY3Rpb24oZWxlbWVudCkge1xuICAgICAgZmlsZVJlYWRlci5yZWFkSW1hZ2UoZWxlbWVudCwgdm0uc2VuZEltYWdlLCAkc2NvcGUpO1xuICAgIH1cblxuICAgIHZtLnNlbmRJbWFnZSA9IGZ1bmN0aW9uKGUpIHtcbiAgICAgIHZtLmVtaXRBbmRQb3N0TWVzc2FnZShlLnRhcmdldC5yZXN1bHQpO1xuICAgIH1cblxuICAgIHZtLnNjcm9sbFRvRW5kID0gZnVuY3Rpb24oKSB7XG4gICAgICAkKCdodG1sLCBib2R5JykuYW5pbWF0ZSh7XG4gICAgICAgIHNjcm9sbFRvcDogJCgnI21lc3NhZ2UtaW5wdXQtYW5jaG9yJykub2Zmc2V0KCkudG9wXG4gICAgICB9LCAnc2xvdycpO1xuICAgIH07XG5cbiAgICB2bS5vbkNsaWNrQmFjayA9IGNvbnN0YW50cy5vbkNsaWNrQmFjaztcblxuICB9O1xufSkoKTtcbiIsIihmdW5jdGlvbigpIHtcbiAgYW5ndWxhclxuICAgIC5tb2R1bGUoJ3dlTWVzc2FnZUFwcCcpXG4gICAgLmNvbnRyb2xsZXIoJ2hvbWVDdHJsJywgaG9tZUN0cmwpO1xuXG4gIGhvbWVDdHJsLiRpbmplY3QgPSBbJyRzY29wZScsICckdWliTW9kYWwnLCAnJGh0dHAnLCAnY29uc3RhbnRzJ107XG4gIGZ1bmN0aW9uIGhvbWVDdHJsKCRzY29wZSwgJHVpYk1vZGFsLCAkaHR0cCwgY29uc3RhbnRzKSB7XG4gICAgdmFyIHZtID0gdGhpcztcbiAgICB2bS5uZXdDaGF0UG9wdXAgPSBmdW5jdGlvbigpIHtcbiAgICAgIHZhciBtb2RhbEluc3RhbmNlID0gJHVpYk1vZGFsLm9wZW4oe1xuICAgICAgICB0ZW1wbGF0ZVVybDogJy9tb2RhbHMvbmV3Q2hhdC9uZXdDaGF0LnZpZXcuaHRtbCcsXG4gICAgICAgIGNvbnRyb2xsZXI6ICduZXdDaGF0Q3RybCBhcyB2bSdcbiAgICAgIH0pO1xuICAgIH07XG4gICAgdm0ucmVnaXN0cmF0aW9uUG9wdXAgPSBmdW5jdGlvbigpIHtcbiAgICAgIHZhciBtb2RhbEluc3RhbmNlID0gJHVpYk1vZGFsLm9wZW4oe1xuICAgICAgICB0ZW1wbGF0ZVVybDogJy9tb2RhbHMvcmVnaXN0ZXIvcmVnaXN0ZXIudmlldy5odG1sJyxcbiAgICAgICAgY29udHJvbGxlcjogJ3JlZ2lzdGVyQ3RybCBhcyB2bSdcbiAgICAgIH0pO1xuICAgIH07XG4gICAgdm0ubG9naW5Qb3B1cCA9IGZ1bmN0aW9uKCkge1xuICAgICAgdmFyIG1vZGFsSW5zdGFuY2UgPSAkdWliTW9kYWwub3Blbih7XG4gICAgICAgIHRlbXBsYXRlVXJsOiAnL21vZGFscy9sb2dpbi9sb2dpbi52aWV3Lmh0bWwnLFxuICAgICAgICBjb250cm9sbGVyOiAnbG9naW5DdHJsIGFzIHZtJ1xuICAgICAgfSk7XG4gICAgfTtcblxuICAgIC8vIFdha2UgdXAgdGhlIEFQSSBzZXJ2ZXIgaWYgaXQncyBhc2xlZXBcbiAgICAkaHR0cCh7XG4gICAgICBtZXRob2Q6ICdHRVQnLFxuICAgICAgdXJsOiBjb25zdGFudHMuYXBpVXJsXG4gICAgfSlcbiAgICAudGhlbihmdW5jdGlvbiBzdWNjZXNzQ2FsbGJhY2socmVzcG9uc2UpIHtcbiAgICAgIGNvbnNvbGUubG9nKHJlc3BvbnNlKTtcbiAgICB9LCBmdW5jdGlvbiBlcnJvckNhbGxiYWNrKHJlc3BvbnNlKSB7XG4gICAgICBjb25zb2xlLmxvZyhyZXNwb25zZSk7XG4gICAgfSk7XG4gICAgfTtcbn0pKCk7XG4iLCIoZnVuY3Rpb24oKSB7XG4gIGFuZ3VsYXJcbiAgICAubW9kdWxlKCd3ZU1lc3NhZ2VBcHAnKVxuICAgIC5jb250cm9sbGVyKCdjaGF0SG9tZUN0cmwnLCBjaGF0SG9tZUN0cmwpO1xuXG4gICAgY2hhdEhvbWVDdHJsLiRpbmplY3QgPSBbJyRzY29wZScsICdjb25zdGFudHMnXTtcbiAgICBmdW5jdGlvbiBjaGF0SG9tZUN0cmwoJHNjb3BlLCBjb25zdGFudHMpIHtcbiAgICAgIHZhciB2bSA9IHRoaXM7XG4gICAgICB2bS5wYWdlVGl0bGUgPSAnV2VNZXNzYWdlIENoYXQnO1xuICAgICAgdm0ub25DbGlja0JhY2sgPSBjb25zdGFudHMub25DbGlja0JhY2s7XG4gICAgfVxufSkoKTtcbiIsIihmdW5jdGlvbigpIHtcbiAgYW5ndWxhclxuICAgIC5tb2R1bGUoJ3dlTWVzc2FnZUFwcCcpXG4gICAgLnNlcnZpY2UoJ2NvbnN0YW50cycsIGNvbnN0YW50cyk7XG5cbiAgZnVuY3Rpb24gY29uc3RhbnRzKCkge1xuICAgIC8vIHZhciBhcGlVcmwgPSAnaHR0cDovL2xvY2FsaG9zdDozMDAwJzsgLy8gdW5jb21tZW50IGZvciBsb2NhbCBBUEkgc2VydmVyXG4gICAgLy8gRGVwbG95ZWQgQVBJIHNlcnZlclxuICAgIHZhciBhcGlVcmwgPSAnaHR0cHM6Ly9vYnNjdXJlLWZvcmVzdC01MDEwNi5oZXJva3VhcHAuY29tJztcbiAgICB2YXIgb25DbGlja0JhY2sgPSBmdW5jdGlvbigpIHtcbiAgICAgIHdpbmRvdy5oaXN0b3J5LmJhY2soKTtcbiAgICB9O1xuICAgIHJldHVybiB7XG4gICAgICBhcGlVcmwgOiBhcGlVcmwsXG4gICAgICBvbkNsaWNrQmFjayA6IG9uQ2xpY2tCYWNrXG4gICAgfTtcbiAgfTtcbn0pKCk7XG4iLCIoZnVuY3Rpb24oKSB7XG4gIGFuZ3VsYXJcbiAgICAubW9kdWxlKCd3ZU1lc3NhZ2VBcHAnKVxuICAgIC5zZXJ2aWNlKCdjdXJyZW50VGltZScsIGN1cnJlbnRUaW1lKTtcblxuICBmdW5jdGlvbiBjdXJyZW50VGltZSgpIHtcbiAgICB2YXIgZ2V0VGltZSA9IG5ldyBEYXRlKCk7XG4gICAgcmV0dXJuIHtcbiAgICAgIG5vdyA6IGdldFRpbWVcbiAgICB9O1xuICB9O1xufSkoKTtcbiIsIihmdW5jdGlvbigpIHtcbiAgYW5ndWxhclxuICAgIC5tb2R1bGUoJ3dlTWVzc2FnZUFwcCcpXG4gICAgLnNlcnZpY2UoJ2ZpbGVSZWFkZXInLCBmaWxlUmVhZGVyKTtcblxuXG4gIGZ1bmN0aW9uIGZpbGVSZWFkZXIoKSB7XG4gICAgLyoqXG4gICAgICogcmVhZHMgaW1hZ2UgZnJvbSBmaWxlIGlucHV0XG4gICAgICogQHBhcmFtIHtET00gZWxlbWVudH0gZWxlbWVudCAtIFBhc3NlZCBpbiBhcyAndGhpcycgZnJvbSBvbmNoYW5nZVxuICAgICAqIEBwYXJhbSB7ZnVuY3Rpb259IGNhbGxiYWNrIC0gZnVuY3Rpb24gdG8gZXhlY3V0ZSBvbiByZWFkIGltYWdlXG4gICAgICogQHBhcmFtIHtBbmd1bGFyIG9iamVjdH0gJHNjb3BlIC0gQW5ndWxhciAkc2NvcGUgb2JqZWN0XG4gICAgICovXG4gICAgdmFyIHJlYWRJbWFnZSA9IGZ1bmN0aW9uKGVsZW1lbnQsIGNhbGxiYWNrLCAkc2NvcGUpIHtcbiAgICAgICRzY29wZS4kYXBwbHkoZnVuY3Rpb24oc2NvcGUpIHtcbiAgICAgICAgdmFyIGltYWdlID0gZWxlbWVudC5maWxlc1swXTtcbiAgICAgICAgdmFyIGlzSW1hZ2UgPSBmYWxzZTtcbiAgICAgICAgaWYoaW1hZ2UudHlwZS5zZWFyY2goJ2ltYWdlJykgIT0gLTEpIHsgaXNJbWFnZSA9IHRydWUgfTtcbiAgICAgICAgaWYoaXNJbWFnZSkge1xuICAgICAgICAgIHZhciByZWFkZXIgPSBuZXcgRmlsZVJlYWRlcigpO1xuICAgICAgICAgIHJlYWRlci5vbmxvYWQgPSBmdW5jdGlvbihlKSB7XG4gICAgICAgICAgICBjYWxsYmFjayhlKTtcbiAgICAgICAgICB9O1xuICAgICAgICAgIHJlYWRlci5yZWFkQXNEYXRhVVJMKGltYWdlKTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfTtcbiAgICByZXR1cm4ge1xuICAgICAgcmVhZEltYWdlIDogcmVhZEltYWdlXG4gICAgfTtcbiAgfTtcbn0pKCk7XG4iLCIoZnVuY3Rpb24gKCkge1xuICBhbmd1bGFyXG4gICAgLm1vZHVsZSgnd2VNZXNzYWdlQXBwJylcbiAgICAuZmlsdGVyKCdwcmV0dGlmeU1lc3NhZ2UnLCBwcmV0dGlmeU1lc3NhZ2UpO1xuXG4gIGZ1bmN0aW9uIHByZXR0aWZ5TWVzc2FnZSgpIHtcbiAgICAvLyBhZGQgbGlua3NcbiAgICBmdW5jdGlvbiBsaW5raWZ5KG1lc3NhZ2UpIHtcbiAgICAgIHZhciBsaW5rcyA9IFtdO1xuICAgICAgdmFyIGNvbnRhaW5zTGluayA9IG1lc3NhZ2Uuc2VhcmNoKC8oaHR0cHM/OlxcL1xcLyk/KFtcXGRhLXpcXC4tXSspXFwuKFthLXpcXC5dezIsNn0pKFtcXC9cXHcgXFwuLV0qKSpcXC8/Lyk7XG4gICAgICBpZihjb250YWluc0xpbmsgIT0gLTEpIHtcbiAgICAgICAgdmFyIHNwbGl0TWVzc2FnZSA9IG1lc3NhZ2Uuc3BsaXQoJyAnKTtcbiAgICAgICAgZm9yKHZhciBpID0gMDsgaSA8IHNwbGl0TWVzc2FnZS5sZW5ndGg7IGkrKykge1xuICAgICAgICAgIGlmKHNwbGl0TWVzc2FnZVtpXS5zZWFyY2goLyhodHRwcz86XFwvXFwvKT8oW1xcZGEtelxcLi1dKylcXC4oW2EtelxcLl17Miw2fSkoW1xcL1xcdyBcXC4tXSopKlxcLz8vKSAhPSAtMSkge1xuICAgICAgICAgICAgdmFyIGxpbmtUZXh0ID0gc3BsaXRNZXNzYWdlW2ldO1xuICAgICAgICAgICAgdmFyIGxpbmtVcmwgPSBsaW5rVGV4dDtcbiAgICAgICAgICAgIC8vIFJlbW92ZSBwdW5jdHVhdGlvbiBmcm9tIGVuZCBvZiBsaW5rIGlmIHByZXNlbnRcbiAgICAgICAgICAgIHZhciBjaGFyYWN0ZXJzID0gWycuJywgJywnLCAnOycsICc6JywgJz8nLCAnXFxcXCddXG4gICAgICAgICAgICBmb3IodmFyIGogPSAwOyBqIDwgY2hhcmFjdGVycy5sZW5ndGg7IGorKykge1xuICAgICAgICAgICAgICBpZihsaW5rVXJsLmVuZHNXaXRoKGNoYXJhY3RlcnNbal0pKSB7XG4gICAgICAgICAgICAgICAgdmFyIHNwbGl0TGluayA9IGxpbmtVcmwuc3BsaXQoY2hhcmFjdGVyc1tqXSk7XG4gICAgICAgICAgICAgICAgc3BsaXRMaW5rLnBvcCgpO1xuICAgICAgICAgICAgICAgIGxpbmtVcmwgPSBzcGxpdExpbmsuam9pbihjaGFyYWN0ZXJzW2pdKTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgLy8gQWRkIFVSTCBwcmVmaXggaWYgbm90IHByZXNlbnRcbiAgICAgICAgICAgIGlmKGxpbmtVcmwuc2VhcmNoKC9eaHR0cC4qJC8pID09IC0xKSB7XG4gICAgICAgICAgICAgIGxpbmtVcmwgPSAnaHR0cDovLycgKyBsaW5rVXJsO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgc3BsaXRNZXNzYWdlW2ldID0gJzxhIGhyZWY9XCInICsgbGlua1VybCArICdcIiB0YXJnZXQ9XCJfYmxhbmtcIj4nICsgbGlua1RleHQgKyAnPC9hPic7XG4gICAgICAgICAgICBsaW5rcy5wdXNoKGxpbmtVcmwpO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBtZXNzYWdlID0gc3BsaXRNZXNzYWdlLmpvaW4oJyAnKTtcbiAgICAgIH1cbiAgICAgIHJldHVybiB7XG4gICAgICAgIGNvbnRlbnQ6IG1lc3NhZ2UsXG4gICAgICAgIGxpbmtzOiBsaW5rc1xuICAgICAgfTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBkaXNwbGF5SW1hZ2VzKG1lc3NhZ2UsIGxpbmtzKSB7XG4gICAgICB2YXIgbnVtTGlua3MgPSBsaW5rcy5sZW5ndGg7XG4gICAgICB2YXIgaW1nVHlwZXMgPSBbJ2pwZycsICdwbmcnLCAnZ2lmJ11cbiAgICAgIGZvcih2YXIgaSA9IDA7IGkgPCBudW1MaW5rczsgaSsrKSB7XG4gICAgICAgIHZhciBsID0gbGlua3NbaV07XG4gICAgICAgIGlmKGwuZW5kc1dpdGgoJ2pwZycpIHx8IGwuZW5kc1dpdGgoJ3BuZycpIHx8IGwuZW5kc1dpdGgoJ2dpZicpKSB7XG4gICAgICAgICAgbWVzc2FnZSArPSAnPGJyPjxpbWcgc3JjPVwiJyArIGwgKyAnXCI+JztcbiAgICAgICAgICBsaW5rcy5zcGxpY2UoaSwgMSk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIHJldHVybiB7XG4gICAgICAgIGNvbnRlbnQ6IG1lc3NhZ2UsXG4gICAgICAgIGxpbmtzOiBsaW5rc1xuICAgICAgfVxuICAgIH1cblxuICAgIGZ1bmN0aW9uIGRpc3BsYXlCYXNlNjQobWVzc2FnZSkge1xuICAgICAgaWYobWVzc2FnZS5zZWFyY2goJ2RhdGE6aW1hZ2UvJykgIT0gLTEpIHtcbiAgICAgICAgbWVzc2FnZSA9ICc8aW1nIHNyYz1cIicgKyBtZXNzYWdlICsgJ1wiPic7XG4gICAgICAgIHJldHVybiBtZXNzYWdlO1xuICAgICAgfVxuICAgICAgZWxzZSByZXR1cm4gZmFsc2U7XG4gICAgfVxuXG4gICAgLy8gRmlsdGVyIG1lc3NhZ2VcbiAgICByZXR1cm4gZnVuY3Rpb24gZmlsdGVyTWVzc2FnZShtZXNzYWdlKSB7XG4gICAgICAvLyBEaXNwbGF5IEJhc2UgNjQgaW1hZ2UgYW5kIGV4aXQgZmlsdGVyXG4gICAgICBpZihkaXNwbGF5QmFzZTY0KG1lc3NhZ2UpKSB7XG4gICAgICAgIG1lc3NhZ2UgPSBkaXNwbGF5QmFzZTY0KG1lc3NhZ2UpO1xuICAgICAgICByZXR1cm4gbWVzc2FnZTtcbiAgICAgIH1cbiAgICAgIC8vIGRldGVjdCBhbmQgbGlua2lmeSBsaW5rc1xuICAgICAgdmFyIGxpbmtlZCA9IGxpbmtpZnkobWVzc2FnZSlcbiAgICAgIC8vIGRldGVjdCBpbWFnZSBsaW5rcyBhbmQgZGlzcGxheSBhcyBpbWFnZXNcbiAgICAgIGlmKGxpbmtlZC5saW5rcykge1xuICAgICAgICB2YXIgaW1hZ2VkID0gZGlzcGxheUltYWdlcyhsaW5rZWQuY29udGVudCwgbGlua2VkLmxpbmtzKTtcbiAgICAgICAgbWVzc2FnZSA9IGltYWdlZC5jb250ZW50O1xuICAgICAgfVxuICAgICAgcmV0dXJuIG1lc3NhZ2U7XG4gICB9O1xuXG4gICAgLy8gRVM2IC5lbmRzV2l0aCBwb2x5ZmlsbFxuICAgIGlmICghU3RyaW5nLnByb3RvdHlwZS5lbmRzV2l0aCkge1xuICAgICAgU3RyaW5nLnByb3RvdHlwZS5lbmRzV2l0aCA9IGZ1bmN0aW9uKHNlYXJjaFN0cmluZywgcG9zaXRpb24pIHtcbiAgICAgICAgdmFyIHN1YmplY3RTdHJpbmcgPSB0aGlzLnRvU3RyaW5nKCk7XG4gICAgICAgIGlmICh0eXBlb2YgcG9zaXRpb24gIT09ICdudW1iZXInIHx8ICFpc0Zpbml0ZShwb3NpdGlvbikgfHwgTWF0aC5mbG9vcihwb3NpdGlvbikgIT09IHBvc2l0aW9uIHx8IHBvc2l0aW9uID4gc3ViamVjdFN0cmluZy5sZW5ndGgpIHtcbiAgICAgICAgICBwb3NpdGlvbiA9IHN1YmplY3RTdHJpbmcubGVuZ3RoO1xuICAgICAgICB9XG4gICAgICAgIHBvc2l0aW9uIC09IHNlYXJjaFN0cmluZy5sZW5ndGg7XG4gICAgICAgIHZhciBsYXN0SW5kZXggPSBzdWJqZWN0U3RyaW5nLmluZGV4T2Yoc2VhcmNoU3RyaW5nLCBwb3NpdGlvbik7XG4gICAgICAgIHJldHVybiBsYXN0SW5kZXggIT09IC0xICYmIGxhc3RJbmRleCA9PT0gcG9zaXRpb247XG4gICAgICB9O1xuICAgIH1cblxuICB9XG59KSgpO1xuIiwiKGZ1bmN0aW9uKCkge1xuICBhbmd1bGFyXG4gICAgLm1vZHVsZSgnd2VNZXNzYWdlQXBwJylcbiAgICAuY29udHJvbGxlcignYWRkQ29udGFjdEN0cmwnLCBhZGRDb250YWN0Q3RybCk7XG5cbiAgYWRkQ29udGFjdEN0cmwuJGluamVjdCA9IFsnJHVpYk1vZGFsSW5zdGFuY2UnLCAnJGh0dHAnLCAnY29uc3RhbnRzJ107XG4gIGZ1bmN0aW9uIGFkZENvbnRhY3RDdHJsKCR1aWJNb2RhbEluc3RhbmNlLCAkaHR0cCwgY29uc3RhbnRzKSB7XG4gICAgdmFyIHZtID0gdGhpcztcbiAgICB2bS5zZWFyY2hVcmwgPSBjb25zdGFudHMuYXBpVXJsICsgJy9hY2NvdW50cy9zZWFyY2gvJ1xuICAgIHZtLmNyZWF0ZVVybCA9IGNvbnN0YW50cy5hcGlVcmwgKyAnL2NvbnRhY3RzJ1xuICAgIHZtLmFjY291bnRpZCA9IGxvY2FsU3RvcmFnZS5nZXRJdGVtKCdhY2NvdW50aWQnKTtcbiAgICB2bS5mb3VuZENvbnRhY3RzID0gW107XG4gICAgdm0ubnVtU2VsZWN0ZWQgPSAwO1xuICAgIC8vIEdldCBhcnJheSBvZiBzZWxlY3RlZCBjb250YWN0cycgaWRzXG4gICAgdm0uZ2V0U2VsZWN0ZWQgPSBmdW5jdGlvbihjb250YWN0cykge1xuICAgICAgdmFyIHNlbGVjdGVkID0gW107XG4gICAgICBmb3IodmFyIGkgPSAwOyBpIDwgY29udGFjdHMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgaWYoY29udGFjdHNbaV0uYWRkZWQpIHtcbiAgICAgICAgICBzZWxlY3RlZC5wdXNoKGNvbnRhY3RzW2ldLmlkKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgcmV0dXJuIHNlbGVjdGVkO1xuICAgIH1cbiAgICB2bS5xdWVyeUtleVVwID0gZnVuY3Rpb24oKSB7XG4gICAgICBpZih2bS5mb3JtRGF0YS5xdWVyeS5sZW5ndGggPiAwKSB7XG4gICAgICAgICRodHRwKHtcbiAgICAgICAgICBtZXRob2Q6ICdHRVQnLFxuICAgICAgICAgIHVybDogdm0uc2VhcmNoVXJsICsgdm0uZm9ybURhdGEucXVlcnksXG4gICAgICAgIH0pXG4gICAgICAgIC50aGVuKGZ1bmN0aW9uIHN1Y2Nlc3NDYWxsYmFjayhyZXNwb25zZSkge1xuICAgICAgICAgIHZtLmZvdW5kQ29udGFjdHMgPSByZXNwb25zZS5kYXRhO1xuICAgICAgICAgIC8vIGdldCBudW1iZXIgb2Ygc2VsZWN0ZWQgY29udGFjdHNcbiAgICAgICAgICB2bS5udW1TZWxlY3RlZCA9IHZtLmdldFNlbGVjdGVkKHZtLmZvdW5kQ29udGFjdHMpLmxlbmd0aDtcbiAgICAgICAgfSwgZnVuY3Rpb24gZXJyb3JDYWxsYmFjayhyZXNwb25zZSkge1xuICAgICAgICAgIGNvbnNvbGUubG9nKHJlc3BvbnNlKTtcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgICBlbHNlIHtcbiAgICAgICAgLy8gRGlzcGxheSBubyBjb250YWN0cyBpZiBubyBxdWVyeSBlbnRlcmVkXG4gICAgICAgIHZtLmZvdW5kQ29udGFjdHMgPSBbXTtcbiAgICAgIH1cbiAgICB9XG4gICAgdm0uc2VsZWN0Q29udGFjdCA9IGZ1bmN0aW9uKGNvbnRhY3QpIHtcbiAgICAgIC8vIFRvZ2dsZSBhZGRlZFxuICAgICAgY29udGFjdC5hZGRlZCA9PSB0cnVlID8gY29udGFjdC5hZGRlZCA9IGZhbHNlIDogY29udGFjdC5hZGRlZCA9IHRydWU7XG4gICAgICAvLyBVcGRhdGUgc2VsZWN0ZWQgY291bnRcbiAgICAgIHZtLm51bVNlbGVjdGVkID0gdm0uZ2V0U2VsZWN0ZWQodm0uZm91bmRDb250YWN0cykubGVuZ3RoO1xuICAgIH1cbiAgICB2bS5jbGlja0FkZCA9IGZ1bmN0aW9uKCkge1xuICAgICAgdmFyIHNlbGVjdGVkID0gdm0uZ2V0U2VsZWN0ZWQodm0uZm91bmRDb250YWN0cyk7XG4gICAgICBmb3IodmFyIGkgPSAwOyBpIDwgc2VsZWN0ZWQubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgJGh0dHAoe1xuICAgICAgICAgIG1ldGhvZDogJ1BPU1QnLFxuICAgICAgICAgIHVybDogdm0uY3JlYXRlVXJsLFxuICAgICAgICAgIGRhdGE6IHtcbiAgICAgICAgICAgIGFkZGVyX2lkOiB2bS5hY2NvdW50aWQsXG4gICAgICAgICAgICBhZGRlZF9pZDogc2VsZWN0ZWRbaV0sXG4gICAgICAgICAgfSxcbiAgICAgICAgICBoZWFkZXJzOiB7XG4gICAgICAgICAgICAgJ0F1dGhvcml6YXRpb24nOiAnQmVhcmVyICcgKyBsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgnYXV0aFRva2VuJylcbiAgICAgICAgICAgfVxuICAgICAgICB9KVxuICAgICAgICAudGhlbihmdW5jdGlvbiBzdWNjZXNzQ2FsbGJhY2socmVzcG9uc2UpIHtcbiAgICAgICAgICAvLyBQYXNzIGFkZGVkIGNvbnRhY3QgaW5mbyBiYWNrIHRvIGNvbnRhY3RzIHBhZ2VcbiAgICAgICAgICAkdWliTW9kYWxJbnN0YW5jZS5jbG9zZShyZXNwb25zZS5kYXRhKTtcbiAgICAgICAgfSwgZnVuY3Rpb24gZXJyb3JDYWxsYmFjayhyZXNwb25zZSkge1xuICAgICAgICAgIGNvbnNvbGUubG9nKHJlc3BvbnNlKTtcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgfVxuICAgIHZtLmNsb3NlTW9kYWwgPSBmdW5jdGlvbigpIHtcbiAgICAgICR1aWJNb2RhbEluc3RhbmNlLmNsb3NlKCk7XG4gICAgfTtcbiAgfVxufSkoKTtcbiIsIihmdW5jdGlvbigpIHtcbiAgYW5ndWxhclxuICAgIC5tb2R1bGUoJ3dlTWVzc2FnZUFwcCcpXG4gICAgLmNvbnRyb2xsZXIoJ2NoYXROaWNrbmFtZUN0cmwnLCBjaGF0Tmlja25hbWVDdHJsKTtcblxuICBjaGF0Tmlja25hbWVDdHJsLiRpbmplY3QgPSBbJyR1aWJNb2RhbEluc3RhbmNlJywgJyRzb2NrZXQnLCAnY2hhdFJvb21EYXRhJ107XG4gIGZ1bmN0aW9uIGNoYXROaWNrbmFtZUN0cmwoJHVpYk1vZGFsSW5zdGFuY2UsICRzb2NrZXQsIGNoYXRSb29tRGF0YSkge1xuICAgIHZhciB2bSA9IHRoaXM7XG4gICAgdm0ucm9vbWlkID0gY2hhdFJvb21EYXRhLnJvb21pZDtcbiAgICB2bS5vblN1Ym1pdCA9IGZ1bmN0aW9uKCkge1xuICAgICAgdm0uZm9ybUVycm9yID0gJyc7XG4gICAgICB2bS5mb3JtRGF0YSA9IHZtLmZvcm1EYXRhIHx8IHt9O1xuICAgICAgaWYoIXZtLmZvcm1EYXRhLm5pY2tuYW1lKSB7XG4gICAgICAgIHZtLmZvcm1FcnJvciA9IFwiUGxlYXNlIGVudGVyIGEgbmlja25hbWUuXCJcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHZtLmpvaW5Sb29tKHZtLmZvcm1EYXRhKTtcbiAgICAgIH1cbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9O1xuICAgIHZtLmpvaW5Sb29tID0gZnVuY3Rpb24oZm9ybURhdGEpIHtcbiAgICAgIGlmKGZvcm1EYXRhLm5pY2tuYW1lKSB7XG4gICAgICAgICRzb2NrZXQuZW1pdCgnam9pbi1yb29tJywge1xuICAgICAgICAgIHJvb21pZDogdm0ucm9vbWlkLFxuICAgICAgICAgIG5pY2tuYW1lOiBmb3JtRGF0YS5uaWNrbmFtZVxuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9O1xuICAgIHZtLmNsb3NlTW9kYWwgPSBmdW5jdGlvbihuYW1lKSB7XG4gICAgICAkdWliTW9kYWxJbnN0YW5jZS5jbG9zZShuYW1lKTtcbiAgICB9O1xuICAgICRzb2NrZXQub24oJ25pY2tuYW1lLXNldCcsIGZ1bmN0aW9uKG5hbWUpIHtcbiAgICAgIHZtLmNsb3NlTW9kYWwobmFtZSk7XG4gICAgfSlcbiAgfVxufSkoKTtcbiIsIihmdW5jdGlvbigpIHtcbiAgYW5ndWxhclxuICAgIC5tb2R1bGUoJ3dlTWVzc2FnZUFwcCcpXG4gICAgLmNvbnRyb2xsZXIoJ2VtYWlsSW52aXRlQ3RybCcsIGVtYWlsSW52aXRlQ3RybCk7XG5cbiAgZW1haWxJbnZpdGVDdHJsLiRpbmplY3QgPSBbJyR1aWJNb2RhbEluc3RhbmNlJywgJyRodHRwJywgJ3NlbmRlckluZm8nXTtcbiAgZnVuY3Rpb24gZW1haWxJbnZpdGVDdHJsKCR1aWJNb2RhbEluc3RhbmNlLCAkaHR0cCwgc2VuZGVySW5mbykge1xuICAgIHZhciB2bSA9IHRoaXM7XG4gICAgdm0uZm9ybURhdGEgPSB7fTtcbiAgICB2bS5mb3JtRGF0YS5zZW5kZXIgPSBzZW5kZXJJbmZvLnNlbmRlcjtcbiAgICB2bS5jaGF0VXJsID0gc2VuZGVySW5mby5jaGF0VXJsO1xuICAgIHZtLm9uQ2xpY2tTZW5kID0gZnVuY3Rpb24oKSB7XG4gICAgICBjb25zb2xlLmxvZygnd2h5Jyk7XG4gICAgICB2bS5mb3JtRXJyb3IgPSAnJztcbiAgICAgIHZtLmZvcm1EYXRhID0gdm0uZm9ybURhdGEgfHwge307XG4gICAgICBpZighdm0uZm9ybURhdGEuc2VuZGVyIHx8ICF2bS5mb3JtRGF0YS5yZWNpcGllbnROYW1lIHx8ICF2bS5mb3JtRGF0YS5yZWNpcGllbnRFbWFpbCkge1xuICAgICAgICB2bS5mb3JtRXJyb3IgPSBcIlBsZWFzZSBjb21wbGV0ZSBhbGwgZmllbGRzLlwiO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdm0uc2VuZE1haWwodm0uZm9ybURhdGEpO1xuICAgICAgICB2bS5jbG9zZU1vZGFsKCdZb3VyIGludml0YXRpb24gd2FzIHNlbnQuJyk7XG4gICAgICB9XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfTtcbiAgICB2bS5zZW5kTWFpbCA9IGZ1bmN0aW9uKGRhdGEpIHtcbiAgICAgIHZhciBtYWlsRGF0YSA9IHtcbiAgICAgICAgc2VuZGVyOiBkYXRhLnNlbmRlcixcbiAgICAgICAgY2hhdFVybDogdm0uY2hhdFVybCxcbiAgICAgICAgcmVjaXBpZW50TmFtZTogZGF0YS5yZWNpcGllbnROYW1lLFxuICAgICAgICByZWNpcGllbnRFbWFpbDogZGF0YS5yZWNpcGllbnRFbWFpbFxuICAgICAgfVxuICAgICAgJGh0dHAucG9zdCgnL2VtYWlsL2ludml0ZS10by1jaGF0JywgbWFpbERhdGEpO1xuICAgIH1cbiAgICB2bS5jbG9zZU1vZGFsID0gZnVuY3Rpb24obWVzc2FnZSkge1xuICAgICAgJHVpYk1vZGFsSW5zdGFuY2UuY2xvc2UobWVzc2FnZSk7XG4gICAgfTtcbiAgICB2bS5vbkNsaWNrQ2FuY2VsID0gZnVuY3Rpb24oKSB7XG4gICAgICB2bS5jbG9zZU1vZGFsKGZhbHNlKTtcbiAgICB9XG4gICAgdm0udGVzdEZ1bmN0aW9uID0gZnVuY3Rpb24oKSB7XG4gICAgICBjb25zb2xlLmxvZygndGVzdCcpO1xuICAgIH1cbiAgfVxufSkoKTtcbiIsIihmdW5jdGlvbigpIHtcbiAgYW5ndWxhclxuICAgIC5tb2R1bGUoJ3dlTWVzc2FnZUFwcCcpXG4gICAgLmNvbnRyb2xsZXIoJ2xvZ2luQ3RybCcsIGxvZ2luQ3RybCk7XG5cbiAgbG9naW5DdHJsLiRpbmplY3QgPSBbJyR1aWJNb2RhbEluc3RhbmNlJywgJyRodHRwJywgJyRsb2NhdGlvbicsICdjb25zdGFudHMnXTtcbiAgZnVuY3Rpb24gbG9naW5DdHJsKCR1aWJNb2RhbEluc3RhbmNlLCAkaHR0cCwgJGxvY2F0aW9uLCBjb25zdGFudHMpIHtcbiAgICB2YXIgdm0gPSB0aGlzO1xuICAgIHZtLmZvcm1EYXRhID0ge307XG4gICAgdm0ubG9naW5VcmwgPSBjb25zdGFudHMuYXBpVXJsICsgJy9hdXRoZW50aWNhdGUvJ1xuICAgIHZtLm9uQ2xpY2tMb2dpbiA9IGZ1bmN0aW9uKCkge1xuICAgICAgdm0uZm9ybUVycm9yID0gJyc7XG4gICAgICB2bS5mb3JtRGF0YSA9IHZtLmZvcm1EYXRhIHx8IHt9O1xuICAgICAgaWYoIXZtLmZvcm1EYXRhLmVtYWlsIHx8ICF2bS5mb3JtRGF0YS5wYXNzd29yZCkge1xuICAgICAgICB2bS5mb3JtRXJyb3IgPSBcIlBsZWFzZSBjb21wbGV0ZSBhbGwgZmllbGRzLlwiO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgY29uc29sZS5sb2coJ2Zvcm0gc3VibWl0dGVkJyk7XG4gICAgICAgICRodHRwKHtcbiAgICAgICAgICBtZXRob2Q6ICdQT1NUJyxcbiAgICAgICAgICB1cmw6IHZtLmxvZ2luVXJsLFxuICAgICAgICAgIGRhdGE6IHtcbiAgICAgICAgICAgIGVtYWlsOiB2bS5mb3JtRGF0YS5lbWFpbCxcbiAgICAgICAgICAgIHBhc3N3b3JkOiB2bS5mb3JtRGF0YS5wYXNzd29yZFxuICAgICAgICAgIH1cbiAgICAgICAgfSlcbiAgICAgICAgLnRoZW4oZnVuY3Rpb24gc3VjY2Vzc0NhbGxiYWNrKHJlc3BvbnNlKSB7XG4gICAgICAgICAgdm0uZm9ybUVycm9yID0gJyc7XG4gICAgICAgICAgLy8gc3RvcmUgYWNjb3VudCBpbmZvcm1hdGlvbiBpbiBsb2NhbFN0b3JhZ2VcbiAgICAgICAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbSgnbG9nZ2VkSW4nLCAndHJ1ZScpO1xuICAgICAgICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKCdhdXRoVG9rZW4nLCByZXNwb25zZS5kYXRhLmF1dGhfdG9rZW4pO1xuICAgICAgICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKCdhY2NvdW50aWQnLCByZXNwb25zZS5kYXRhLmFjY291bnQuaWQpO1xuICAgICAgICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKCdhY2NvdW50TmFtZScsIHJlc3BvbnNlLmRhdGEuYWNjb3VudC5uYW1lKTtcbiAgICAgICAgICAvLyByZWRpcmVjdCB0byBjb250YWN0cyBwYWdlXG4gICAgICAgICAgdmFyIGNvbnRhY3RzUGFnZSA9ICcvY29udGFjdHMnO1xuICAgICAgICAgICRsb2NhdGlvbi5wYXRoKGNvbnRhY3RzUGFnZSk7XG4gICAgICAgIH0sIGZ1bmN0aW9uIGVycm9yQ2FsbGJhY2socmVzcG9uc2UpIHtcbiAgICAgICAgICBpZihyZXNwb25zZS5kYXRhLmVycm9ycykge1xuICAgICAgICAgICAgdm0uZm9ybUVycm9yID0gcmVzcG9uc2UuZGF0YS5lcnJvcnNbMF07XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcblxuICAgICAgfVxuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH07XG5cbiAgICB2bS5vbkNsaWNrQ2FuY2VsID0gZnVuY3Rpb24oKSB7XG4gICAgICAkdWliTW9kYWxJbnN0YW5jZS5jbG9zZSgpO1xuICAgIH1cbiAgfVxufSkoKTtcbiIsIihmdW5jdGlvbigpIHtcbiAgYW5ndWxhclxuICAgIC5tb2R1bGUoJ3dlTWVzc2FnZUFwcCcpXG4gICAgLmNvbnRyb2xsZXIoJ2xvZ291dEN0cmwnLCBsb2dvdXRDdHJsKTtcblxuICBsb2dvdXRDdHJsLiRpbmplY3QgPSBbJyR1aWJNb2RhbEluc3RhbmNlJywgJyRsb2NhdGlvbiddO1xuICBmdW5jdGlvbiBsb2dvdXRDdHJsKCR1aWJNb2RhbEluc3RhbmNlLCAkbG9jYXRpb24pIHtcbiAgICB2YXIgdm0gPSB0aGlzO1xuICAgIHZtLm9uQ29uZmlybUxvZ291dCA9IGZ1bmN0aW9uKCkge1xuICAgICAgY29uc29sZS5sb2coJ2NvbmZpcm1lZCcpO1xuICAgICAgbG9jYWxTdG9yYWdlLmNsZWFyKCk7XG4gICAgICB2bS5jbG9zZU1vZGFsKCk7XG4gICAgICAkbG9jYXRpb24ucGF0aCgnLycpO1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH07XG4gICAgdm0uY2xvc2VNb2RhbCA9IGZ1bmN0aW9uKCkge1xuICAgICAgJHVpYk1vZGFsSW5zdGFuY2UuY2xvc2UoKTtcbiAgICB9O1xuICB9XG59KSgpO1xuIiwiKGZ1bmN0aW9uKCkge1xuICBhbmd1bGFyXG4gICAgLm1vZHVsZSgnd2VNZXNzYWdlQXBwJylcbiAgICAuY29udHJvbGxlcignbmV3Q2hhdEN0cmwnLCBuZXdDaGF0Q3RybCk7XG5cbiAgbmV3Q2hhdEN0cmwuJGluamVjdCA9IFsnJHVpYk1vZGFsSW5zdGFuY2UnLCAnJGxvY2F0aW9uJ107XG4gIGZ1bmN0aW9uIG5ld0NoYXRDdHJsKCR1aWJNb2RhbEluc3RhbmNlLCAkbG9jYXRpb24pIHtcbiAgICB2YXIgdm0gPSB0aGlzO1xuICAgIHZtLm9uU3VibWl0ID0gZnVuY3Rpb24oKSB7XG4gICAgICB2bS5mb3JtRXJyb3IgPSAnJztcbiAgICAgIHZtLmZvcm1EYXRhID0gdm0uZm9ybURhdGEgfHwge307XG4gICAgICBpZighdm0uZm9ybURhdGEucm9vbU5hbWUpIHtcbiAgICAgICAgdm0uZm9ybUVycm9yID0gXCJQbGVhc2UgZW50ZXIgYSBuYW1lIGZvciB5b3VyIGNoYXRyb29tLlwiXG4gICAgICB9IGVsc2Uge1xuICAgICAgICB2bS5mb3JtRXJyb3IgPSAnJztcbiAgICAgICAgJGxvY2F0aW9uLnBhdGgoJy9jaGF0LycgKyB2bS5mb3JtRGF0YS5yb29tTmFtZSk7XG4gICAgICB9XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfTtcbiAgICB2bS5jbG9zZU1vZGFsID0gZnVuY3Rpb24oKSB7XG4gICAgICAkdWliTW9kYWxJbnN0YW5jZS5jbG9zZSgpO1xuICAgIH07XG4gIH1cbn0pKCk7XG4iLCIoZnVuY3Rpb24oKSB7XG4gIGFuZ3VsYXJcbiAgICAubW9kdWxlKCd3ZU1lc3NhZ2VBcHAnKVxuICAgIC5jb250cm9sbGVyKCdyZWdpc3RlckN0cmwnLCByZWdpc3RlckN0cmwpO1xuXG4gIHJlZ2lzdGVyQ3RybC4kaW5qZWN0ID0gWyckdWliTW9kYWxJbnN0YW5jZScsICckaHR0cCcsICckbG9jYXRpb24nLCAnJHNjb3BlJywgJ2ZpbGVSZWFkZXInLCAnY29uc3RhbnRzJ107XG4gIGZ1bmN0aW9uIHJlZ2lzdGVyQ3RybCgkdWliTW9kYWxJbnN0YW5jZSwgJGh0dHAsICRsb2NhdGlvbiwgJHNjb3BlLCBmaWxlUmVhZGVyLCBjb25zdGFudHMpIHtcbiAgICB2YXIgdm0gPSB0aGlzO1xuICAgIHZtLmZvcm1EYXRhID0ge307XG4gICAgdm0ucmVnaXN0ZXJVcmwgPSBjb25zdGFudHMuYXBpVXJsICsgJy9yZWdpc3Rlci8nXG4gICAgdm0ub25DbGlja1JlZ2lzdGVyID0gZnVuY3Rpb24oKSB7XG4gICAgICB2bS5mb3JtRXJyb3IgPSAnJztcbiAgICAgIHZtLmZvcm1EYXRhID0gdm0uZm9ybURhdGEgfHwge307XG4gICAgICBpZighdm0uZm9ybURhdGEubmFtZSB8fCAhdm0uZm9ybURhdGEuZW1haWwgfHwgIXZtLmZvcm1EYXRhLnBhc3N3b3JkKSB7XG4gICAgICAgIHZtLmZvcm1FcnJvciA9IFwiUGxlYXNlIGNvbXBsZXRlIGFsbCByZXF1aXJlZCBmaWVsZHMuXCI7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBjb25zb2xlLmxvZygnZm9ybSBzdWJtaXR0ZWQnKTtcbiAgICAgICAgJGh0dHAoe1xuICAgICAgICAgIG1ldGhvZDogJ1BPU1QnLFxuICAgICAgICAgIHVybDogdm0ucmVnaXN0ZXJVcmwsXG4gICAgICAgICAgZGF0YToge1xuICAgICAgICAgICAgbmFtZTogdm0uZm9ybURhdGEubmFtZSxcbiAgICAgICAgICAgIGVtYWlsOiB2bS5mb3JtRGF0YS5lbWFpbCxcbiAgICAgICAgICAgIHBhc3N3b3JkOiB2bS5mb3JtRGF0YS5wYXNzd29yZCxcbiAgICAgICAgICAgIGltYWdlOiB2bS5wcm9maWxlSW1hZ2VcbiAgICAgICAgICB9XG4gICAgICAgIH0pXG4gICAgICAgIC50aGVuKGZ1bmN0aW9uIHN1Y2Nlc3NDYWxsYmFjayhyZXNwb25zZSkge1xuICAgICAgICAgIHZtLmZvcm1FcnJvciA9ICcnO1xuICAgICAgICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKCdsb2dnZWRJbicsICd0cnVlJyk7XG4gICAgICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oJ2F1dGhUb2tlbicsIHJlc3BvbnNlLmRhdGEuYXV0aF90b2tlbik7XG4gICAgICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oJ2FjY291bnRpZCcsIHJlc3BvbnNlLmRhdGEuYWNjb3VudC5pZCk7XG4gICAgICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oJ2FjY291bnROYW1lJywgcmVzcG9uc2UuZGF0YS5hY2NvdW50Lm5hbWUpO1xuICAgICAgICAgICRsb2NhdGlvbi5wYXRoKCcvY29udGFjdHMnKTtcbiAgICAgICAgfSwgZnVuY3Rpb24gZXJyb3JDYWxsYmFjayhyZXNwb25zZSkge1xuICAgICAgICAgIGlmKHJlc3BvbnNlLmRhdGEuZW1haWwpIHtcbiAgICAgICAgICAgIHZtLmZvcm1FcnJvciA9ICdXZSBhbHJlYWR5IGhhdmUgYW4gYWNjb3VudCBhc3NvY2lhdGVkIHdpdGggdGhhdCBlbWFpbCBhZGRyZXNzLidcbiAgICAgICAgICB9XG4gICAgICAgICAgZWxzZSBpZihyZXNwb25zZS5kYXRhLnBhc3N3b3JkKSB7XG4gICAgICAgICAgICB2bS5mb3JtRXJyb3IgPSAnUGxlYXNlIHVzZSBhIHBhc3N3b3JkIG9mIHNpeCBjaGFyYWN0ZXJzIG9yIG1vcmUuJ1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB2bS5mb3JtRXJyb3IgPSAnVGhlcmUgd2FzIGFuIGVycm9yIHByb2Nlc3NpbmcgeW91ciByZWdpc3RyYXRpb24sIHBsZWFzZSB0cnkgYWdhaW4gbGF0ZXIuJ1xuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG5cbiAgICAgIH1cbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9O1xuXG4gICAgJHNjb3BlLnVwbG9hZEltYWdlID0gZnVuY3Rpb24oZWxlbWVudCkge1xuICAgICAgZmlsZVJlYWRlci5yZWFkSW1hZ2UoZWxlbWVudCwgdm0uc2V0UHJvZmlsZUltYWdlLCAkc2NvcGUpO1xuICAgIH1cblxuICAgIHZtLnNldFByb2ZpbGVJbWFnZSA9IGZ1bmN0aW9uKGUpIHtcbiAgICAgIHZhciBpbWFnZSA9IGUudGFyZ2V0LnJlc3VsdDtcbiAgICAgIGlmKGltYWdlKSB7XG4gICAgICAgIC8vICRzY29wZS5hcHBseSBzbyBuZy1zcmMgcGlja3MgdXAgdGhlIGNoYW5nZVxuICAgICAgICAkc2NvcGUuJGFwcGx5KGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICB2bS5wcm9maWxlSW1hZ2UgPSBpbWFnZTtcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgdm0ub25DbGlja0NhbmNlbCA9IGZ1bmN0aW9uKCkge1xuICAgICAgJHVpYk1vZGFsSW5zdGFuY2UuY2xvc2UoKTtcbiAgICB9XG4gIH1cbn0pKCk7XG4iLCIoZnVuY3Rpb24oKSB7XG4gIGFuZ3VsYXJcbiAgICAubW9kdWxlKCd3ZU1lc3NhZ2VBcHAnKVxuICAgIC5kaXJlY3RpdmUoJ21haW5Gb290ZXInLCBbJ2N1cnJlbnRUaW1lJywgbWFpbkZvb3Rlcl0pO1xuXG4gIG1haW5Gb290ZXIuJGluamVjdCA9IFsnY3VycmVudFRpbWUnXTtcbiAgZnVuY3Rpb24gbWFpbkZvb3RlcihjdXJyZW50VGltZSkge1xuICAgIC8vIHZhciBkYXRlVG9kYXkgPSBEYXRlLm5vdygpO1xuICAgIHJldHVybiB7XG4gICAgICByZXN0cmljdDogJ0VBJyxcbiAgICAgIHNjb3BlOiB7fSxcbiAgICAgIGxpbms6IGZ1bmN0aW9uIChzY29wZSkge1xuICAgICAgICBzY29wZS50b2RheXNEYXRlID0gY3VycmVudFRpbWUubm93O1xuICAgICAgfSxcbiAgICAgIHRlbXBsYXRlVXJsOiAnL2NvbW1vbi9kaXJlY3RpdmVzL21haW5Gb290ZXIvbWFpbkZvb3Rlci50ZW1wbGF0ZS5odG1sJ1xuICAgIH07XG4gIH1cbn0pKCk7XG4iLCIoZnVuY3Rpb24oKSB7XG4gIGFuZ3VsYXJcbiAgICAubW9kdWxlKCd3ZU1lc3NhZ2VBcHAnKVxuICAgIC5kaXJlY3RpdmUoJ21haW5OYXZpZ2F0aW9uJywgbWFpbk5hdmlnYXRpb24pO1xuXG4gIG1haW5OYXZpZ2F0aW9uLiRpbmplY3QgPSBbJyR1aWJNb2RhbCddO1xuICBmdW5jdGlvbiBtYWluTmF2aWdhdGlvbigkdWliTW9kYWwpIHtcbiAgICB2YXIgb25DbGlja0xvZ291dCA9IGZ1bmN0aW9uIG9uQ2xpY2tMb2dvdXQoKSB7XG4gICAgICBjb25zb2xlLmxvZygnd2hhdHR1cCcpO1xuICAgICAgdmFyIG1vZGFsSW5zdGFuY2UgPSAkdWliTW9kYWwub3Blbih7XG4gICAgICAgIHRlbXBsYXRlVXJsOiAnL21vZGFscy9sb2dvdXQvbG9nb3V0LnZpZXcuaHRtbCcsXG4gICAgICAgIGNvbnRyb2xsZXI6ICdsb2dvdXRDdHJsIGFzIHZtJ1xuICAgICAgfSk7XG4gICAgfVxuICAgIHJldHVybiB7XG4gICAgICByZXN0cmljdDogJ0VBJyxcbiAgICAgIHRlbXBsYXRlVXJsOiAnL2NvbW1vbi9kaXJlY3RpdmVzL21haW5OYXZpZ2F0aW9uL21haW5OYXZpZ2F0aW9uLnRlbXBsYXRlLmh0bWwnLFxuICAgICAgbGluazogZnVuY3Rpb24gKHNjb3BlKSB7XG4gICAgICAgIHNjb3BlLm9uQ2xpY2tMb2dvdXQgPSBvbkNsaWNrTG9nb3V0O1xuICAgICAgICBzY29wZS5sb2dnZWRJbiA9IGxvY2FsU3RvcmFnZS5nZXRJdGVtKCdsb2dnZWRJbicpO1xuICAgICAgfVxuICAgIH07XG4gIH1cbn0pKCk7XG4iLCIoZnVuY3Rpb24oKSB7XG4gIGFuZ3VsYXJcbiAgICAubW9kdWxlKCd3ZU1lc3NhZ2VBcHAnKVxuICAgIC5kaXJlY3RpdmUoJ21lc3NhZ2VFbnRyeScsIG1lc3NhZ2VFbnRyeSk7XG5cbiAgZnVuY3Rpb24gbWVzc2FnZUVudHJ5KCkge1xuICAgIHJldHVybiB7XG4gICAgICByZXN0cmljdDogJ0VBJyxcbiAgICAgIHJlcXVpcmU6ICduZ01vZGVsJyxcbiAgICAgIHRlbXBsYXRlVXJsOiAnL2NvbW1vbi9kaXJlY3RpdmVzL21lc3NhZ2VFbnRyeS9tZXNzYWdlRW50cnkudGVtcGxhdGUuaHRtbCdcbiAgICB9O1xuICB9XG59KSgpO1xuIl0sInNvdXJjZVJvb3QiOiIvc291cmNlLyJ9
